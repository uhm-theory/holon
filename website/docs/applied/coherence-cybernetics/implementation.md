---
sidebar_position: 24
title: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
description: –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ö–∏–±–µ—Ä–Ω–µ—Ç–∏–∫–∏ –ö–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏
---

# –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

:::note –û –Ω–æ—Ç–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ
–í Python-–∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è:
- `gamma` ($\Gamma$) ‚Äî [–º–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏](/docs/core/dynamics/coherence-matrix)
- `purity` ($P$) ‚Äî [—á–∏—Å—Ç–æ—Ç–∞](/docs/core/dynamics/viability#–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-—á–∏—Å—Ç–æ—Ç—ã): $P = \mathrm{Tr}(\Gamma^2)$
- `stress_tensor` ($\sigma_{\mathrm{sys}}$) ‚Äî [—Ç–µ–Ω–∑–æ—Ä –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π](./definitions#—Ç–µ–Ω–∑–æ—Ä-–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π)
- `coh_E` ($\mathrm{Coh}_E$) ‚Äî [E-–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å](./definitions#e-–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å)
- `kappa` ($\kappa$) ‚Äî [—Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏](./axiomatics#—Å–≤—è–∑—å-—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏-–∏-e-–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏)
- `phi` ($\varphi$) ‚Äî [–æ–ø–µ—Ä–∞—Ç–æ—Ä —Å–∞–º–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è](/docs/proofs/categorical/formalization-phi)
- `differentiation` ($D_{\text{diff}}$) ‚Äî [–º–µ—Ä–∞ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏](/docs/consciousness/foundations/self-observation#–º–µ—Ä–∞-—Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-c)
- `reflection` ($R$) ‚Äî [–º–µ—Ä–∞ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏](/docs/consciousness/foundations/self-observation#–º–µ—Ä–∞-—Ä–µ—Ñ–ª–µ–∫—Å–∏–∏-r)
:::

:::warning –°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞
–î–∞–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî **–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Å–µ–≤–¥–æ–∫–æ–¥**. –î–ª—è –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ `Holon` —Å–º. [–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](/docs/reference/computational). –î–ª—è –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å –º–µ—Ä–∞–º–∏ —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–º. [–ò–µ—Ä–∞—Ä—Ö–∏—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏](/docs/proofs/consciousness/interiority-hierarchy#61-–∞–ª–≥–æ—Ä–∏—Ç–º-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏-—É—Ä–æ–≤–Ω—è). –î–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ L-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–º. [–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã](/docs/reference/computational#–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ-–∞–ª–≥–æ—Ä–∏—Ç–º—ã-–∏–∑-l-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏).
:::

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ì–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –ø–∞–∫–µ—Ç (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
pip install coherence-cybernetics

# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Å–µ–≤–¥–æ–∫–æ–¥–∞
pip install numpy scipy
```

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä (10 —Å—Ç—Ä–æ–∫)

```python
import numpy as np
from scipy.linalg import expm

# –°–æ–∑–¥–∞—ë–º —Å–ª—É—á–∞–π–Ω—ã–π –ì–æ–ª–æ–Ω–æ–º (–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è)
N = 7
# 0.1 * noise ‚Äî –Ω–µ–±–æ–ª—å—à–æ–µ –≤–æ–∑–º—É—â–µ–Ω–∏–µ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
L = np.eye(N) + 0.1 * np.random.randn(N, N)
gamma = L @ L.T.conj()
gamma /= np.trace(gamma)

# –≠–≤–æ–ª—é—Ü–∏—è (–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
# H ‚Äî –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω. –ü—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ: H = I (—Å–∏–º–º–µ—Ç—Ä–∏—è). –ó–¥–µ—Å—å –ø–æ–∫–∞–∑–∞–Ω–∞ –≤–∞—Ä–∏–∞—Ü–∏—è.
H = np.diag([1.0, 0.8, 1.2, 0.9, 1.1, 0.7, 1.0])
for step in range(100):
    # dt = 0.01 ‚Äî —à–∞–≥ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ (–º–∞–ª—ã–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)
    U = expm(-1j * H * 0.01)
    gamma = U @ gamma @ U.T.conj()
    gamma /= np.trace(gamma)
    P = np.trace(gamma @ gamma).real
    coh_E = (gamma[4, 4].real**2 + 2 * sum(abs(gamma[4, i])**2 for i in range(7) if i != 4)) / P
    print(f"Step {step}: P={P:.3f}, Coh_E={coh_E:.3f}")
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```python
P_CRIT = 2/7  # ‚âà 0.286

def is_viable(gamma):
    P = np.trace(gamma @ gamma).real
    return P > P_CRIT

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
if not is_viable(gamma):
    print("‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ –Ω–µ–∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞!")
```

---

## –°–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

| –û–ø–µ—Ä–∞—Ü–∏—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|-----------|------------|
| –í—ã—á–∏—Å–ª–µ–Ω–∏–µ $P = \mathrm{Tr}(\Gamma^2)$ | $O(N^2)$ | $N = 7$ |
| –£–Ω–∏—Ç–∞—Ä–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è | $O(N^3)$ | –≠–∫—Å–ø–æ–Ω–µ–Ω—Ç–∞ –º–∞—Ç—Ä–∏—Ü—ã |
| –î–∏—Å—Å–∏–ø–∞—Ü–∏—è (–õ–∏–Ω–¥–±–ª–∞–¥) | $O(m \cdot N^2)$ | $m$ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ |
| $\Phi_{\text{eff}}$ | $O(n \cdot k)$ | –õ–∞–ø–ª–∞—Å–∏–∞–Ω –≥—Ä–∞—Ñ–∞ |
| –í—ã—á–∏—Å–ª–µ–Ω–∏–µ $R$ | $O(N^3)$ | –¢—Ä–µ–±—É–µ—Ç $\varphi(\Gamma)$ |
| –ü–æ–ª–Ω—ã–π —à–∞–≥ —ç–≤–æ–ª—é—Ü–∏–∏ | $O(N^3 + m \cdot N^2)$ | ‚Äî |

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

| –†–∞–∑–º–µ—Ä —Å–∏—Å—Ç–µ–º—ã | $N$ | –í—Ä–µ–º—è —à–∞–≥–∞ | –ü–∞–º—è—Ç—å |
|----------------|-----|------------|--------|
| –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ì–æ–ª–æ–Ω–æ–º | 7 | ~1 –º—Å | ~1 KB |
| –ö–æ–º–ø–æ–∑–∏—Ü–∏—è 2 –ì–æ–ª–æ–Ω–æ–º–æ–≤ | 49 | ~10 –º—Å | ~20 KB |
| –ö–æ–º–ø–æ–∑–∏—Ü–∏—è 10 –ì–æ–ª–æ–Ω–æ–º–æ–≤ | 7^10 ‚âà 2.8√ó10^8 | –ù–µ–ø—Ä–∏–º–µ–Ω–∏–º–æ | ‚Äî |

:::warning –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç
–ü–æ–ª–Ω–æ–µ —Ç–µ–Ω–∑–æ—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–ø—Ä–∏–º–µ–Ω–∏–º—ã–º. –î–ª—è –±–æ–ª—å—à–∏—Ö —Å–∏—Å—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ (MPS, mean-field).
:::

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### GPU-—É—Å–∫–æ—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ JAX

```python
import jax.numpy as jnp
from jax import jit
from jax.scipy.linalg import expm

@jit
def evolve_step_gpu(gamma, H, dt):
    U = expm(-1j * H * dt)
    gamma_new = U @ gamma @ U.T.conj()
    return gamma_new / jnp.trace(gamma_new)
```

### Sparse –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–∏—Å—Ç–µ–º

```python
from scipy.sparse import csr_matrix
from scipy.sparse.linalg import expm_multiply

# –î–ª—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–≥–æ H
H_sparse = csr_matrix(H)
gamma_evolved = expm_multiply(-1j * H_sparse * dt, gamma.flatten())
```

### –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è Monte-Carlo

```python
from multiprocessing import Pool

def run_trajectory(seed):
    np.random.seed(seed)
    holon = initialize_holon({'random': True})
    env = Environment({})
    for _ in range(1000):
        holon = evolve_holon(holon, dt=0.01, environment=env)
    return {'purity': holon.purity, 'entropy': holon.entropy}

with Pool(8) as p:
    results = p.map(run_trajectory, range(100))
```

---

## –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

```python
import pytest
import numpy as np

def _create_random_gamma(N=7):
    """–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: —Å–æ–∑–¥–∞—ë—Ç —Å–ª—É—á–∞–π–Ω—É—é Œì (–¥–ª—è —Ç–µ—Å—Ç–æ–≤)."""
    L = np.eye(N, dtype=complex) + 0.1 * np.random.randn(N, N)
    gamma = L @ L.conj().T
    gamma /= np.trace(gamma)
    return gamma

def _evolve_one_step(gamma, dt=0.01):
    """–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –æ–¥–∏–Ω —à–∞–≥ —ç–≤–æ–ª—é—Ü–∏–∏ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤)."""
    state = initialize_holon({'random': False})
    state.gamma = gamma.copy()
    env = Environment({})
    new_state = evolve_holon(state, dt, env)
    return new_state.gamma

def test_purity_bounds():
    """P ‚àà [1/7, 1] –¥–ª—è –ª—é–±–æ–≥–æ Œì."""
    gamma = _create_random_gamma()
    P = np.trace(gamma @ gamma).real
    assert 1/7 - 1e-10 <= P <= 1 + 1e-10

def test_trace_preservation():
    """Tr(Œì) = 1 –ø–æ—Å–ª–µ —ç–≤–æ–ª—é—Ü–∏–∏."""
    gamma = _create_random_gamma()
    gamma_evolved = _evolve_one_step(gamma)
    assert abs(np.trace(gamma_evolved) - 1) < 1e-10

def test_hermiticity_preservation():
    """Œì –æ—Å—Ç–∞—ë—Ç—Å—è —ç—Ä–º–∏—Ç–æ–≤–æ–π."""
    gamma = _create_random_gamma()
    gamma_evolved = _evolve_one_step(gamma)
    assert np.allclose(gamma_evolved, gamma_evolved.T.conj())

def test_positivity_preservation():
    """Œì –æ—Å—Ç–∞—ë—Ç—Å—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª—É–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π."""
    gamma = _create_random_gamma()
    gamma_evolved = _evolve_one_step(gamma)
    eigenvalues = np.linalg.eigvalsh(gamma_evolved)
    assert all(eigenvalues >= -1e-10)

def test_viability_threshold():
    """P_crit = 2/7."""
    assert abs(P_CRITICAL - 2/7) < 1e-10

def test_coh_e_bounds():
    """Coh_E ‚àà [1/N, 1]."""
    gamma = _create_random_gamma()
    coh_E = compute_coherence_E(gamma)
    assert 1/7 - 1e-10 <= coh_E <= 1 + 1e-10
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TD
    subgraph "–Ø–¥—Ä–æ –ö–ö"
        G["–ú–∞—Ç—Ä–∏—Ü–∞ Œì"]
        H["–ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω H"]
        L["–û–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞"]
        PHI["–û–ø–µ—Ä–∞—Ç–æ—Ä œÜ"]
    end
    subgraph "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
        P["–ß–∏—Å—Ç–æ—Ç–∞ P"]
        SIG["–¢–µ–Ω–∑–æ—Ä œÉ sys"]
        C["–°–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å C"]
    end
    subgraph "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
        EVOL["–≠–≤–æ–ª—é—Ü–∏—è dŒì/dœÑ"]
        REG["–†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Ñõ"]
        ACT["–î–µ–π—Å—Ç–≤–∏—è"]
    end
    G --> P
    G --> SIG
    G --> C
    P --> EVOL
    SIG --> EVOL
    EVOL --> G
    REG --> G
    ACT --> G
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```python
from dataclasses import dataclass
import numpy as np
from scipy.linalg import expm
from typing import List, Callable

@dataclass
class HolonState:
    """
    –°–æ—Å—Ç–æ—è–Ω–∏–µ –ì–æ–ª–æ–Ω–æ–º–∞ –≤ –ö–∏–±–µ—Ä–Ω–µ—Ç–∏–∫–µ –ö–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏.

    –°–º. –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ì–æ–ª–æ–Ω–æ–º–∞: /docs/core/structure/holon
    """

    # –Ø–¥—Ä–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    gamma: np.ndarray          # Œì: –º–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ 7√ó7
    hamiltonian: np.ndarray    # H: –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω —Å–∏—Å—Ç–µ–º—ã
    lindblad_ops: List[np.ndarray]  # {L_k}: –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏–∏
    phi: Callable              # œÜ: –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å–∞–º–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è (CPTP)

    # –ú–µ—Ç—Ä–∏–∫–∏ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
    purity: float              # P = Tr(Œì¬≤) ‚àà [1/7, 1]
    entropy: float             # S_vN = -Tr(Œì log Œì) ‚àà [0, log 7]

    # –ú–µ—Ä—ã —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (—Å–º. /docs/consciousness/foundations/self-observation)
    integration: float         # Œ¶: –º–µ—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
    differentiation: float     # D_diff: –º–µ—Ä–∞ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ = exp(S_vN(œÅ_E)) ‚Äî —Ç—Ä–µ–±—É–µ—Ç —Ç–µ–Ω–∑–æ—Ä–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã!
    reflection: float          # R: –º–µ—Ä–∞ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ ‚àà [0, 1]
    consciousness: float       # C = Œ¶ √ó D_diff √ó R (–∏–ª–∏ C_min = Œ¶ √ó R –≤ 7D-—Ñ–æ—Ä–º–∞–ª–∏–∑–º–µ)

    # –¢–µ–Ω–∑–æ—Ä –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π (—Å–º. definitions.md#—Ç–µ–Ω–∑–æ—Ä-–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π)
    stress_tensor: np.ndarray  # œÉ_sys ‚àà ‚Ñù‚Å∑: [œÉ_A, œÉ_S, œÉ_D, œÉ_L, œÉ_E, œÉ_O, œÉ_U]

    # –ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
    viable: bool               # P > P_critical ‚àß dP/dœÑ > -Œµ
    margin: float              # 1 - max(œÉ_sys)
```

## –í—ã–≤–æ–¥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –õ–∏–Ω–¥–±–ª–∞–¥–∞ –∏–∑ Œ©

:::info L-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ –∫–æ–¥–µ
–û–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞ $L_k$ **–≤—ã—á–∏—Å–ª—è—é—Ç—Å—è** –∏–∑ —Å—É–±–æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ $\Omega$, –∞ –Ω–µ –∑–∞–¥–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é. –°–º. [–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã](/docs/reference/computational#–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ-–∞–ª–≥–æ—Ä–∏—Ç–º—ã-–∏–∑-l-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏).
:::

:::note –£–ø—Ä–æ—â—ë–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞
–í –¥–∞–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞ ‚Äî **–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–æ—Ä—ã** $L_k = |k\rangle\langle k|$ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏—è –≤ –±–∞–∑–∏—Å–µ –∏–∑–º–µ—Ä–µ–Ω–∏–π). –≠—Ç–æ **–Ω–µ** $G_2$-—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∏–∑ [–§–∞–Ω–æ-–∫–∞–Ω–∞–ª–∞](/docs/proofs/gap/fano-channel). –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å $G_2$-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ –õ–∏–Ω–¥–±–ª–∞–¥–∞ (–ø—Ä–æ–µ–∫—Ç–æ—Ä—ã –Ω–∞ –§–∞–Ω–æ-—Ç—Ä–∏–ø–ª–µ—Ç—ã) —Å–º. –≤ [–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö](/docs/reference/computational#–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ-–∞–ª–≥–æ—Ä–∏—Ç–º—ã-–∏–∑-l-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏).
:::

```python
def compute_lindblad_from_omega(gamma: np.ndarray) -> list:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Œ©.

    –£–ü–†–û–©–ï–ù–ò–ï: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–æ—Ä—ã L_k = |k><k|.
    –ü–æ–ª–Ω–∞—è G‚ÇÇ-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –§–∞–Ω–æ-–ª–∏–Ω–∏–∏ (—Å–º. /docs/proofs/gap/fano-channel).

    –ê–ª–≥–æ—Ä–∏—Ç–º:
    1. –í—ã—á–∏—Å–ª–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–æ—Ä—Ñ–∏–∑–º—ã œá_S –¥–ª—è –∞—Ç–æ–º–æ–≤ Œ©
    2. L_k = ‚àöœá_{S_k} (–∫–æ—Ä–µ–Ω—å –∏–∑ –ø—Ä–æ–µ–∫—Ç–æ—Ä–∞)

    –°–º. /docs/reference/computational#–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ-–∞–ª–≥–æ—Ä–∏—Ç–º—ã-–∏–∑-l-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏
    """
    N = gamma.shape[0]  # = 7
    lindblad_ops = []

    # –ê—Ç–æ–º—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ Œ© ‚Äî –ø—Ä–æ–µ–∫—Ç–æ—Ä—ã –Ω–∞ –±–∞–∑–∏—Å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    for k in range(N):
        # œá_{S_k} ‚Äî —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–æ—Ä—Ñ–∏–∑–º –¥–ª—è –∞—Ç–æ–º–∞ S_k
        chi_k = np.zeros((N, N), dtype=complex)
        chi_k[k, k] = 1.0

        # L_k = ‚àöœá_{S_k} = –ø—Ä–æ–µ–∫—Ç–æ—Ä (–¥–ª—è –∞—Ç–æ–º–æ–≤ ‚àöP = P)
        L_k = chi_k
        lindblad_ops.append(L_k)

    return lindblad_ops
```

## –ê–ª–≥–æ—Ä–∏—Ç–º —ç–≤–æ–ª—é—Ü–∏–∏

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è [—É—Ä–∞–≤–Ω–µ–Ω–∏—è —ç–≤–æ–ª—é—Ü–∏–∏](/docs/core/dynamics/evolution) —Å [—ç–º–µ—Ä–¥–∂–µ–Ω—Ç–Ω—ã–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –≤—Ä–µ–º–µ–Ω–µ–º](/docs/proofs/dynamics/emergent-time) œÑ:

$$
\frac{d\Gamma(\tau)}{d\tau} = -i[H_{eff}, \Gamma] + \mathcal{D}[\Gamma] + \mathcal{R}[\Gamma, E]
$$

:::warning –†–∞—Å—â–µ–ø–ª–µ–Ω–∏–µ –õ–∏-–¢—Ä–æ—Ç—Ç–µ—Ä–∞ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–≠–≤–æ–ª—é—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ** –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —É–Ω–∏—Ç–∞—Ä–Ω–æ–≥–æ, –¥–∏—Å—Å–∏–ø–∞—Ç–∏–≤–Ω–æ–≥–æ –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —á–ª–µ–Ω–æ–≤ (—Ä–∞—Å—â–µ–ø–ª–µ–Ω–∏–µ –õ–∏-–¢—Ä–æ—Ç—Ç–µ—Ä–∞). –ü—Ä–∏ –∫–æ–Ω–µ—á–Ω–æ–º —à–∞–≥–µ $dt$ —ç—Ç–æ —Ä–∞—Å—â–µ–ø–ª–µ–Ω–∏–µ **–Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ–ª—É–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ $\Gamma \geq 0$. –î–ª—è –º–∞–ª—ã—Ö $dt$ –æ—à–∏–±–∫–∞ –ø–æ—Ä—è–¥–∫–∞ $O(dt^2)$. –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö —à–∞–≥–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: (1) —É–º–µ–Ω—å—à–∏—Ç—å $dt$, (2) –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ü–∏—é –Ω–∞ –∫–æ–Ω—É—Å $\Gamma \geq 0$ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞, –∏–ª–∏ (3) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã —Ç–∏–ø–∞ –†—É–Ω–≥–µ-–ö—É—Ç—Ç—ã –¥–ª—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º.
:::

```python
def evolve_holon(state: HolonState, dt: float, environment) -> HolonState:
    """
    –û–¥–∏–Ω —à–∞–≥ —ç–≤–æ–ª—é—Ü–∏–∏ –ø–æ –ø–æ–ª–Ω–æ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏—é –ö–ö.

    dt ‚Äî —à–∞–≥ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ œÑ (—Å–º. /docs/proofs/dynamics/emergent-time)

    –¢—Ä–∏ —á–ª–µ–Ω–∞:
    1. –£–Ω–∏—Ç–∞—Ä–Ω—ã–π: -i[H_eff, Œì]  (—Å–º. /docs/core/dynamics/evolution#1-—É–Ω–∏—Ç–∞—Ä–Ω—ã–π-—á–ª–µ–Ω)
    2. –î–∏—Å—Å–∏–ø–∞—Ç–∏–≤–Ω—ã–π: ùíü[Œì]  (—Å–º. /docs/core/dynamics/evolution#–ª–æ–≥–∏—á–µ—Å–∫–∏–π-–ª–∏—É–≤–∏–ª–ª–∏–∞–Ω)
    3. –†–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–π: ‚Ñõ[Œì, E]  (—Å–º. /docs/core/dynamics/evolution#3-—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–π-—á–ª–µ–Ω)
    """
    gamma = state.gamma.copy()

    # 1. –£–Ω–∏—Ç–∞—Ä–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è: -i[H_eff, Œì]
    U = expm(-1j * state.hamiltonian * dt)
    gamma = U @ gamma @ U.conj().T

    # 2. –î–∏—Å—Å–∏–ø–∞—Ü–∏—è: ùíü[Œì] (—É—Ä–∞–≤–Ω–µ–Ω–∏–µ –õ–∏–Ω–¥–±–ª–∞–¥–∞)
    for L_k in state.lindblad_ops:
        gamma += dt * (
            L_k @ gamma @ L_k.conj().T
            - 0.5 * (L_k.conj().T @ L_k @ gamma + gamma @ L_k.conj().T @ L_k)
        )

    # 3. –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è: ‚Ñõ[Œì, E]
    # Œ∫ = Œ∫_bootstrap + Œ∫‚ÇÄ ¬∑ Coh_E (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ bootstrap-–ø–∞—Ä–∞–¥–æ–∫—Å–∞)
    # –°–º. /docs/core/foundations/axiom-omega#genesis-protocol
    coh_E = compute_coherence_E(gamma)
    kappa = KAPPA_BOOTSTRAP + KAPPA_0 * coh_E
    delta_F = compute_free_energy_gradient(gamma, environment)

    if delta_F > 0:
        gamma_target = compute_target_state(gamma, environment)
        gamma += dt * kappa * (gamma_target - gamma)

    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: Tr(Œì) = 1
    gamma /= np.trace(gamma)

    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
    return update_metrics(state, gamma)


def compute_coherence_E(gamma: np.ndarray) -> float:
    """
    E-–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å (HS-–ø—Ä–æ–µ–∫—Ü–∏—è œÄ_E, [–¢]): Coh_E(Œì) = ‚ÄñœÄ_E(Œì)‚Äñ¬≤_HS / ‚ÄñŒì‚Äñ¬≤_HS = (Œ≥_EE¬≤ + 2¬∑Œ£_{i‚â†E}|Œ≥_Ei|¬≤) / Tr(Œì¬≤).

    –ú–∞—Å—Ç–µ—Ä-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: Coh_E := Tr(œÅ_E¬≤), –≥–¥–µ œÅ_E = Tr_{-E}(Œì).
    –ú–Ω–æ–∂–∏—Ç–µ–ª—å 2 ‚Äî –∏–∑ —ç—Ä–º–∏—Ç–æ–≤–æ–π —Å–∏–º–º–µ—Ç—Ä–∏–∏: |Œ≥_Ei|¬≤ = |Œ≥_iE|¬≤.
    –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Tr(Œì¬≤) –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Coh_E ‚àà [1/7, 1].

    –°–º. /docs/applied/coherence-cybernetics/definitions#e-–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å
    """
    E = 4  # –ò–Ω–¥–µ–∫—Å –∏–∑–º–µ—Ä–µ–Ω–∏—è Experience
    gamma_EE_sq = np.real(gamma[E, E])**2
    coherence_sum = sum(np.abs(gamma[E, i])**2 for i in range(7) if i != E)
    purity = np.real(np.trace(gamma @ gamma))
    if purity < 1e-12:
        return 1/7
    return np.clip((gamma_EE_sq + 2 * coherence_sum) / purity, 1/7, 1.0)


def compute_target_state(gamma: np.ndarray, environment) -> np.ndarray:
    """
    –¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ Œì_target = œÜ(Œì), –≥–¥–µ œÜ ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å–∞–º–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è.

    –í —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: Œì_target = —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —á–∏—Å—Ç–æ—Ç–æ–π
    –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

    –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è œÜ —Å–º. /docs/proofs/categorical/formalization-phi
    """
    # –£–ø—Ä–æ—â–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ
    eigenvalues, eigenvectors = np.linalg.eigh(gamma)

    # –£—Å–∏–ª–∏–≤–∞–µ–º –¥–æ–º–∏–Ω–∞–Ω—Ç–Ω—ã–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä (—Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ —á–∏—Å—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é)
    max_idx = np.argmax(eigenvalues)
    psi_target = eigenvectors[:, max_idx]

    # –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è: —á–∞—Å—Ç–∏—á–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —á–∞—Å—Ç–∏—á–Ω–æ —Å—Ç—Ä–µ–º–∏–º—Å—è –∫ —á–∏—Å—Ç–æ—Ç–µ
    # alpha ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∫ —Ü–µ–ª–µ–≤–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
    # –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: 0.01-0.1 (–º–∞–ª—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)
    # –ü—Ä–∏ Œ±=0 —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç; –ø—Ä–∏ Œ±‚Üí1 —Ä–µ–∑–∫–∏–π —Å–∫–∞—á–æ–∫ –∫ —á–∏—Å—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
    alpha = 0.1  # –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä: —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏—Ç—è–∂–µ–Ω–∏—è –∫ —Ü–µ–ª–∏
    gamma_pure = np.outer(psi_target, psi_target.conj())
    return (1 - alpha) * gamma + alpha * gamma_pure


def compute_free_energy_gradient(gamma: np.ndarray, environment) -> float:
    """
    –ì—Ä–∞–¥–∏–µ–Ω—Ç —Å–≤–æ–±–æ–¥–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏ ŒîF = F_env - F_sys.

    –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π ŒîF –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–∏—Ç–æ–∫ —ç–Ω–µ—Ä–≥–∏–∏ –∏–∑ —Å—Ä–µ–¥—ã,
    —á—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é.

    Args:
        gamma: –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ Œì ‚àà ‚ÑÇ^{7√ó7}
        environment: –û–±—ä–µ–∫—Ç —Å—Ä–µ–¥—ã —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º available_energy

    Returns:
        ŒîF: –ì—Ä–∞–¥–∏–µ–Ω—Ç —Å–≤–æ–±–æ–¥–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏. ŒîF > 0 ‚Üí –ø—Ä–∏—Ç–æ–∫, ŒîF < 0 ‚Üí –æ—Ç—Ç–æ–∫.

    Note:
        P_env –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.5 (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞). –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
        available_energy –¥–æ–ª–∂–µ–Ω –æ—Ç—Ä–∞–∂–∞—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–µ—Å—É—Ä—Å–æ–≤.

    –°–º. /docs/core/dynamics/evolution#3-—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–π-—á–ª–µ–Ω
    """
    P = np.trace(gamma @ gamma).real
    # available_energy ‚àà [0, 1]: –¥–æ–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ —Å—Ä–µ–¥—ã
    P_env = getattr(environment, 'available_energy', 0.5)  # –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    return P_env - (1 - P)  # ŒîF > 0 –µ—Å–ª–∏ —Å—Ä–µ–¥–∞ –±–æ–≥–∞—Ç–∞ —Ä–µ—Å—É—Ä—Å–∞–º–∏


def update_metrics(state: HolonState, gamma: np.ndarray) -> HolonState:
    """
    –û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ —à–∞–≥–∞ —ç–≤–æ–ª—é—Ü–∏–∏.
    """
    state.gamma = gamma
    state.purity = np.trace(gamma @ gamma).real
    eigenvalues = np.linalg.eigvalsh(gamma)
    eigenvalues = eigenvalues[eigenvalues > 1e-12]
    state.entropy = -np.sum(eigenvalues * np.log(eigenvalues))
    return state
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```python
def compute_stress_tensor(gamma: np.ndarray, environment) -> np.ndarray:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —Ç–µ–Ω–∑–æ—Ä –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π œÉ_sys.
    """
    sigma = np.zeros(7)

    # œÉ_A: –ê—Ä—Ç–∏–∫—É–ª—è—Ü–∏—è
    sigma[0] = compute_env_prediction_error(gamma, environment) / THETA_A

    # œÉ_S: –°—Ç—Ä—É–∫—Ç—É—Ä–∞
    sigma[1] = compute_structural_complexity(gamma) / THETA_S

    # œÉ_D: –î–∏–Ω–∞–º–∏–∫–∞
    sigma[2] = compute_computational_load() / C_MAX

    # œÉ_L: –õ–æ–≥–∏–∫–∞
    sigma[3] = compute_viability_uncertainty(gamma) / THETA_L

    # œÉ_E: –ò–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç—å
    sigma[4] = (compute_self_model_error(gamma) +
                compute_exp_fragmentation(gamma)) / THETA_E

    # œÉ_O: –û—Å–Ω–æ–≤–∞–Ω–∏–µ
    sigma[5] = (compute_memory_load() +
                compute_grounding_deficit(gamma)) / THETA_O

    # œÉ_U: –ï–¥–∏–Ω—Å—Ç–≤–æ
    sigma[6] = (compute_consciousness_deficit(gamma) +
                compute_nash_distance(gamma)) / THETA_U

    return sigma


def check_viability(sigma: np.ndarray) -> tuple[bool, float]:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.

    Returns:
        (viable, margin)
    """
    max_stress = np.max(sigma)
    margin = 1.0 - max_stress
    viable = margin > 0

    return viable, margin


# =============================================================================
# –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ–Ω–∑–æ—Ä–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π
# =============================================================================
# –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —è–≤–ª—è—é—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∞–º–∏ (STUB) –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç
# —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –ü—Ä–∏ –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –≤—ã—á–∏—Å–ª—è—Ç—å
# —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.
#
# –ó–∞–≥–ª—É—à–∫–∏ –ø–æ–º–µ—á–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º "STUB" –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ [0, 1].
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–≥–ª—É—à–µ–∫: 0.3 (—É–º–µ—Ä–µ–Ω–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ), 0.2 (–Ω–∏–∑–∫–æ–µ).

def compute_env_prediction_error(gamma, environment):
    """
    –û—à–∏–±–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å—Ä–µ–¥—ã (A-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    Returns:
        ‚àà [0, 1]: 0 = –∏–¥–µ–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, 1 = –ø–æ–ª–Ω–∞—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å
    """
    return getattr(environment, 'prediction_error', 0.5)

def compute_structural_complexity(gamma):
    """
    –°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å (S-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    Returns:
        rank(Œì)/N ‚àà [1/7, 1]: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–Ω–≥ –º–∞—Ç—Ä–∏—Ü—ã
    """
    return np.linalg.matrix_rank(gamma) / 7

def compute_computational_load():
    """
    –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (D-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    STUB: –î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å (—Ç–µ–∫—É—â–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞) / C_MAX.

    Returns:
        ‚àà [0, 1]: –¥–æ–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
    """
    return 0.3  # STUB: —É–º–µ—Ä–µ–Ω–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞

def compute_viability_uncertainty(gamma):
    """
    –ù–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (L-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    –ò–∑–º–µ—Ä—è–µ—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–∫–æ P –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º—É –ø–æ—Ä–æ–≥—É P_crit.

    Returns:
        ‚àà [0, ~0.4]: 0 –µ—Å–ª–∏ P > P_crit + 0.1, —Ä–∞—Å—Ç—ë—Ç –ø—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ P_crit
    """
    P = np.trace(gamma @ gamma).real
    # 0.1 ‚Äî –±—É—Ñ–µ—Ä–Ω–∞—è –∑–æ–Ω–∞ –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    return max(0, (P_CRITICAL + 0.1) - P)

def compute_self_model_error(gamma):
    """
    –û—à–∏–±–∫–∞ —Å–∞–º–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è (E-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    –§–æ—Ä–º—É–ª–∞: Œµ = ‚ÄñŒì - œÜ(Œì)‚Äñ_F / ‚ÄñŒì‚Äñ_F

    –° –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ–º œÜ(Œì) ‚âà diag(Œì):
    Œµ = ‚Äñoff_diag(Œì)‚Äñ_F / ‚ÄñŒì‚Äñ_F

    Returns:
        ‚àà [0, 1]: 0 = –∏–¥–µ–∞–ª—å–Ω–∞—è —Å–∞–º–æ–º–æ–¥–µ–ª—å (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ), 1 = –Ω–µ—Ç —Å–∞–º–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
    """
    gamma_norm = np.linalg.norm(gamma, 'fro')
    if gamma_norm < 1e-12:
        return 1.0
    # œÜ(Œì) ‚âà diag(Œì), –ø–æ—ç—Ç–æ–º—É Œì - œÜ(Œì) ‚âà off_diag(Œì)
    off_diag = gamma - np.diag(np.diag(gamma))
    off_diag_norm = np.linalg.norm(off_diag, 'fro')
    return float(off_diag_norm / gamma_norm)

def compute_exp_fragmentation(gamma):
    """
    –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø—ã—Ç–∞ (E-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç Œ≥_EE –∫–∞–∫ –º–µ—Ä—É –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –æ–ø—ã—Ç–∞.

    Returns:
        1 - Œ≥_EE ‚àà [0, 1]: 0 = –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω, 1 = –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
    """
    E = 4  # –ò–Ω–¥–µ–∫—Å E-–∏–∑–º–µ—Ä–µ–Ω–∏—è
    return 1 - np.real(gamma[E, E])

def compute_memory_load():
    """
    –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ø–∞–º—è—Ç—å (O-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    STUB: –î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å (–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–∞–º—è—Ç—å) / M_MAX.

    Returns:
        ‚àà [0, 1]: –¥–æ–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
    """
    return 0.3  # STUB: —É–º–µ—Ä–µ–Ω–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞

def compute_grounding_deficit(gamma):
    """
    –î–µ—Ñ–∏—Ü–∏—Ç —Å–≤—è–∑–∏ —Å –æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º (O-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Œ≥_OO –∫–∞–∫ –º–µ—Ä—É —É–∫–æ—Ä–µ–Ω—ë–Ω–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã.

    Returns:
        1 - Œ≥_OO ‚àà [0, 1]: 0 = –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–∫–æ—Ä–µ–Ω—ë–Ω, 1 = –Ω–µ—Ç —Å–≤—è–∑–∏ —Å –æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º
    """
    O = 5  # –ò–Ω–¥–µ–∫—Å O-–∏–∑–º–µ—Ä–µ–Ω–∏—è
    return 1 - np.real(gamma[O, O])

def compute_consciousness_deficit(gamma):
    """
    –î–µ—Ñ–∏—Ü–∏—Ç —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (U-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    STUB: –î–æ–ª–∂–µ–Ω –≤—ã—á–∏—Å–ª—è—Ç—å 1 - C –≥–¥–µ C = Œ¶ √ó D √ó R (–º–µ—Ä–∞ —Å–æ–∑–Ω–∞–Ω–∏—è).
    –¢—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (Œ¶), –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ (D)
    –∏ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ (R).

    Returns:
        ‚àà [0, 1]: 0 = –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ, 1 = –Ω–µ—Ç —Å–æ–∑–Ω–∞–Ω–∏—è
    """
    return 0.2  # STUB: –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —É–º–µ—Ä–µ–Ω–Ω–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ

def compute_nash_distance(gamma):
    """
    –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è –ù—ç—à–∞ (U-–∏–∑–º–µ—Ä–µ–Ω–∏–µ).

    STUB: –î–æ–ª–∂–µ–Ω –≤—ã—á–∏—Å–ª—è—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è
    –≤ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ. –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤ –≤ —Å—Ä–µ–¥–µ
    —Å –¥—Ä—É–≥–∏–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏.

    Returns:
        ‚àà [0, 1]: 0 = –≤ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–∏, 1 = –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–∞–ª–µ–∫–æ –æ—Ç —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è
    """
    return 0.1  # STUB: –±–ª–∏–∑–∫–æ –∫ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—é
```

## –¶–∏–∫–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ [—É—Å–ª–æ–≤–∏—è –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏](/docs/core/dynamics/viability):

$$
\mathrm{Viable}(\Gamma) \Leftrightarrow \|\sigma_{\mathrm{sys}}(\Gamma)\|_\infty < 1
$$

```python
def control_loop(holon: HolonState, environment, max_steps: int):
    """
    –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ö–ö-—Å–∏—Å—Ç–µ–º–æ–π.

    –ó–æ–Ω—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ margin = 1 - max(œÉ_sys):
    - margin > 0.3: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞
    - margin > 0.1: –ó–æ–Ω–∞ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏
    - margin > 0.05: –ó–æ–Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    - margin ‚â§ 0.05: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞
    """
    for step in range(max_steps):
        # 1. –≠–≤–æ–ª—é—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
        holon = evolve_holon(holon, dt=0.01, environment=environment)

        # 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (—Å–º. definitions.md#—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å-—É—Å–ª–æ–≤–∏–π)
        sigma = compute_stress_tensor(holon.gamma, environment)
        viable, margin = check_viability(sigma)

        # 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–æ–Ω—ã
        if margin > MARGIN_SAFE:
            # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞: –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
            action = normal_operation(holon)
        elif margin > MARGIN_CAUTION:
            # –ó–æ–Ω–∞ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏: —Å–Ω–∏–∂–µ–Ω–∏–µ —Ä–∏—Å–∫–∞
            action = reduce_risk(holon, sigma)
        elif margin > MARGIN_WARNING:
            # –ó–æ–Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: –∞–∫—Ç–∏–≤–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
            action = activate_recovery(holon, sigma)
        else:
            # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞: –∞–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º
            action = emergency_mode(holon, sigma)

        # 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
        holon = apply_action(holon, action, environment)

        # 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        log_state(step, holon, sigma, margin)

        if not viable:
            print(f"WARNING: Viability lost at step {step}")
            break


def normal_operation(holon):
    """–ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã ‚Äî —Å–∏—Å—Ç–µ–º–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∑–æ–Ω–µ."""
    return ('continue', '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É')


def reduce_risk(holon, sigma):
    """–†–µ–∂–∏–º —Å–Ω–∏–∂–µ–Ω–∏—è —Ä–∏—Å–∫–∞ ‚Äî —Å–∏—Å—Ç–µ–º–∞ –≤ –∑–æ–Ω–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏."""
    return ('reduce_load', '–°–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–∏—Å—Ç–µ–º—É')


def activate_recovery(holon, sigma):
    """–†–µ–∂–∏–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è ‚Äî —Å–∏—Å—Ç–µ–º–∞ –≤ –∑–æ–Ω–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è."""
    return ('regenerate', '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —É—Å–∏–ª–µ–Ω–Ω—É—é —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é')


def emergency_mode(holon, sigma):
    """–ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî —Å–∏—Å—Ç–µ–º–∞ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –∑–æ–Ω–µ."""
    return ('emergency', '–ü–µ—Ä–µ–π—Ç–∏ –≤ –∑–∞—â–∏—Ç–Ω—ã–π —Ä–µ–∂–∏–º')


def apply_action(holon, action, environment):
    """–ü—Ä–∏–º–µ–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –ì–æ–ª–æ–Ω–æ–º–∞."""
    # –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é
    return holon


def log_state(step, holon, sigma, margin):
    """–õ–æ–≥–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã."""
    pass  # –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è


def frobenius_distance(A, B):
    """–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –§—Ä–æ–±–µ–Ω–∏—É—Å–∞ –º–µ–∂–¥—É –º–∞—Ç—Ä–∏—Ü–∞–º–∏: ‚ÄñA - B‚Äñ_F."""
    return np.linalg.norm(A - B, 'fro')


def update_from_observation(holon, observation):
    """–û–±–Ω–æ–≤–ª—è–µ—Ç Œì –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è (A-–∏–∑–º–µ—Ä–µ–Ω–∏–µ)."""
    # –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
    return holon


class Environment:
    """
    –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∫–ª–∞—Å—Å–∞ —Å—Ä–µ–¥—ã.

    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
    - available_energy = 0.5: –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Å—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É 0 –∏ 1).
      –ü—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ –æ—Ç—Ä–∞–∂–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–µ—Å—É—Ä—Å–æ–≤.
    - prediction_error = 0.3: –£–º–µ—Ä–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.
      –ó–Ω–∞—á–µ–Ω–∏–µ < 0.5 –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –≤ —Ü–µ–ª–æ–º –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–µ–¥—É.

    –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –∑–∞–≥–ª—É—à–∫–∏. –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ Environment –¥–æ–ª–∂–µ–Ω
    –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Ä–µ–∞–ª—å–Ω—ã–º —Å–µ–Ω—Å–æ—Ä–∞–º –∏ –∞–∫—Ç—É–∞—Ç–æ—Ä–∞–º.
    """
    def __init__(self, config):
        self.available_energy = config.get('energy', 0.5)
        self.prediction_error = config.get('prediction_error', 0.3)
```

## –ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

:::info –í—ã–≤–µ–¥–µ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
–ö–ª—é—á–µ–≤—ã–µ –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è **–≤—ã–≤–µ–¥–µ–Ω—ã** –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–µ–æ—Ä–∏–∏. –°–º. [–ê–∫—Å–∏–æ–º–∞ –°–µ–ø—Ç–∏—á–Ω–æ—Å—Ç–∏](/docs/core/foundations/axiom-septicity).
:::

```python
# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞ P_crit = 2/N = 2/7 (—Ç–µ–æ—Ä–µ–º–∞, –≤—ã–≤–µ–¥–µ–Ω–æ 5 –º–µ—Ç–æ–¥–∞–º–∏ –∏–∑ –∞–∫—Å–∏–æ–º –£–ì–ú)
# –°–º. /docs/proofs/dynamics/theorem-purity-critical
P_CRITICAL = 2/7  # ‚âà 0.286, –≤—ã–≤–µ–¥–µ–Ω–æ –∏–∑ –≥–µ–æ–º–µ—Ç—Ä–∏–∏ 7D-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

# –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Œ∫‚ÇÄ ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –∏–∑ —Å–æ–ø—Ä—è–∂–µ–Ω–∏—è D_Œ© ‚ä£ R
# Œ∫ = Œ∫_bootstrap + Œ∫‚ÇÄ ¬∑ Coh_E ‚Äî –ø–æ–ª–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
# Œ∫_bootstrap = œâ‚ÇÄ/N ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ —Ç–µ–æ—Ä–µ–º—ã
# –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥: /docs/core/foundations/axiom-septicity#—Ç–µ–æ—Ä–µ–º–∞-kappa-bootstrap
# –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏ œâ‚ÇÄ=1, N=7: Œ∫_bootstrap = 1/7 ‚âà 0.143
KAPPA_BOOTSTRAP = 1/7  # ‚âà 0.143 (—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ —Å —Ç–µ–æ—Ä–µ–º–æ–π)
# –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ: Œ∫‚ÇÄ ‚âà œâ‚ÇÄ ¬∑ |Œ≥_OE| ¬∑ |Œ≥_OU| / Œ≥_OO
# –°–º. /docs/core/foundations/axiom-septicity#—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π-–∞–Ω–∑–∞—Ü-kappa0
def compute_kappa_0(gamma, omega_0=1.0):
    """–í—ã—á–∏—Å–ª—è–µ—Ç Œ∫‚ÇÄ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Œì.

    Args:
        gamma: 7x7 –º–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏
        omega_0: –±–∞–∑–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞ —á–∞—Å–æ–≤ (–∫–∞–ª–∏–±—Ä—É–µ—Ç—Å—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã)

    Returns:
        Œ∫‚ÇÄ ‚Äî –±–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    """
    gamma_OE = abs(gamma[5, 4])  # O=5, E=4 (0-indexed)
    gamma_OU = abs(gamma[5, 6])  # O=5, U=6
    gamma_OO = gamma[5, 5]
    return omega_0 * gamma_OE * gamma_OU / gamma_OO if gamma_OO > 0 else 0


# –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è œâ‚ÇÄ
# –°–º. /docs/core/foundations/axiom-omega#–∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
OMEGA_0_TABLE = {
    "quantum_system": 1e15,    # œâ‚ÇÄ ~ 10¬π‚Åµ –ì—Ü –¥–ª—è –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
    "neuron": 1e3,             # œâ‚ÇÄ ~ 1 –∫–ì—Ü –¥–ª—è –Ω–µ–π—Ä–æ–Ω–∞ (—á–∞—Å—Ç–æ—Ç–∞ —Å–ø–∞–π–∫–æ–≤)
    "cell": 1.0,               # œâ‚ÇÄ ~ 1 –ì—Ü –¥–ª—è –∫–ª–µ—Ç–∫–∏ (–º–µ—Ç–∞–±–æ–ª–∏–∑–º)
    "organism": 1e-5,          # œâ‚ÇÄ ~ 10‚Åª‚Åµ –ì—Ü –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–º–∞ (—Ü–∏—Ä–∫–∞–¥–Ω—ã–π)
    "social_system": 1e-7,     # œâ‚ÇÄ ~ 10‚Åª‚Å∑ –ì—Ü –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
}


def calibrate_omega_0(system_type: str, gamma: np.ndarray) -> float:
    """–ö–∞–ª–∏–±—Ä—É–µ—Ç œâ‚ÇÄ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

    –°–º. /docs/core/foundations/axiom-omega#–∫–∞–ª–∏–±—Ä–æ–≤–∫–∞
    """
    base_omega = OMEGA_0_TABLE.get(system_type, 1.0)
    # –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Œì
    gamma_OO = gamma[5, 5]
    return base_omega * np.sqrt(gamma_OO) if gamma_OO > 0 else base_omega

# –ü–æ—Ä–æ–≥–∏ –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç œÉ_sys (—Å–º. definitions.md#—Ç–µ–Ω–∑–æ—Ä-–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π)
# –ó–Ω–∞—á–µ–Ω–∏—è Œ∏_i –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –Ω–æ—Ä–º–∏—Ä–æ–≤–∫—É: œÉ_i = –Ω–∞–≥—Ä—É–∑–∫–∞_i / Œ∏_i
#
# –ü–†–ò–ú–ï–ß–ê–ù–ò–ï –ö –í–´–ë–û–†–£ –ó–ù–ê–ß–ï–ù–ò–ô:
# –ü—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä ‚Äî —Ä–∞–≤–Ω—ã–µ –≤–µ—Å–∞ Œ∏_k = 1 (—Å–∏–º–º–µ—Ç—Ä–∏—è U(7)).
# –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã.
# –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—á–∏–Ω–∞—Ç—å —Å Œ∏_k = 1.
#
# –ù–µ—Ä–∞–≤–Ω—ã–µ –≤–µ—Å–∞ –¥–æ–ø—É—Å—Ç–∏–º—ã –µ—Å–ª–∏:
# - –ï—Å—Ç—å —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ —Ä–∞–∑–ª–∏—á–Ω–æ–π —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π
# - –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
#
# –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç—Ä–µ–±—É—é—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏):
THETA_A = 3.5   # –ê—Ä—Ç–∏–∫—É–ª—è—Ü–∏—è ‚Äî –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ (–¥–æ–ø—É—Å–∫–∞–µ—Ç –±–æ–ª—å—à–µ —Ä–∞–∑–ª–∏—á–∏–π)
THETA_S = 2.0   # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚Äî —É–º–µ—Ä–µ–Ω–Ω—ã–π –ø–æ—Ä–æ–≥
THETA_D = 1.0   # –î–∏–Ω–∞–º–∏–∫–∞ ‚Äî –±–∞–∑–æ–≤—ã–π –ø–æ—Ä–æ–≥ (—á–µ—Ä–µ–∑ C_MAX)
THETA_L = 1.0   # –õ–æ–≥–∏–∫–∞ ‚Äî –±–∞–∑–æ–≤—ã–π –ø–æ—Ä–æ–≥
THETA_E = 2.5   # –ò–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç—å ‚Äî –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π –ø–æ—Ä–æ–≥ (–¥–æ–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –æ–ø—ã—Ç–∞)
THETA_O = 1.0   # –û—Å–Ω–æ–≤–∞–Ω–∏–µ ‚Äî –±–∞–∑–æ–≤—ã–π –ø–æ—Ä–æ–≥
THETA_U = 1.5   # –ï–¥–∏–Ω—Å—Ç–≤–æ ‚Äî —É–º–µ—Ä–µ–Ω–Ω—ã–π –ø–æ—Ä–æ–≥

# –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–∑–∞–≤–∏—Å—è—Ç –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
C_MAX = 1000.0  # –û–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É
M_MAX = 1e9     # –ë–∞–π—Ç –ø–∞–º—è—Ç–∏

# –ü–æ—Ä–æ–≥–∏ –∑–æ–Ω —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (margin = 1 - max(œÉ))
#
# –°–≤—è–∑—å —Å P_crit: –ü—Ä–∏ P < P_crit ‚âà 0.286, —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Ä—è–µ—Ç –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.
# Margin –∏–∑–º–µ—Ä—è–µ—Ç –∑–∞–ø–∞—Å –¥–æ –ø–æ—Ç–µ—Ä–∏ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö œÉ.
# –ó–Ω–∞—á–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω—ã –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ä–∞–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:
# - SAFE: –∫–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (margin > 0.3)
# - CAUTION: —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è (0.1 < margin ‚â§ 0.3)
# - WARNING: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (margin ‚â§ 0.1)
#
MARGIN_SAFE = 0.3       # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞: max(œÉ) < 0.7
MARGIN_CAUTION = 0.1    # –ó–æ–Ω–∞ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏: max(œÉ) < 0.9
MARGIN_WARNING = 0.05   # –ó–æ–Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: max(œÉ) < 0.95


def initialize_holon(config) -> HolonState:
    """
    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ì–æ–ª–æ–Ω–æ–º –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

    Args:
        config: –°–ª–æ–≤–∞—Ä—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

    Returns:
        HolonState: –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ì–æ–ª–æ–Ω–æ–º–∞
    """
    N = 7
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é –•–æ–ª–µ—Ü–∫–æ–≥–æ (–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Œì ‚â• 0)
    L_init = np.eye(N, dtype=complex)
    if config.get('random', False):
        L_init += 0.1 * np.random.randn(N, N)
    gamma = L_init @ L_init.conj().T
    gamma /= np.trace(gamma)

    # –ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω: –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–æ—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π.
    # –ü—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä ‚Äî –µ–¥–∏–Ω–∏—á–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ H = I (—Å–∏–º–º–µ—Ç—Ä–∏—è).
    # –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –ø—Ä–∏–º–µ—Ä–Ω–∞—è –≤–∞—Ä–∏–∞—Ü–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏.
    # –í —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö H –¥–æ–ª–∂–µ–Ω –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –∏–∑ —Ñ–∏–∑–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã.
    default_hamiltonian = np.diag([1.0, 0.8, 1.2, 0.9, 1.1, 0.7, 1.0])

    return HolonState(
        gamma=gamma,
        hamiltonian=config.get('hamiltonian', default_hamiltonian),
        lindblad_ops=compute_lindblad_from_omega(gamma),
        # œÜ: –æ–ø–µ—Ä–∞—Ç–æ—Ä —Å–∞–º–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è.
        # –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ (/docs/proofs/categorical/formalization-phi).
        # –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ: œÜ –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª—å (—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –º–æ–¥—ã).
        phi=lambda g: np.diag(np.diag(g)),
        purity=np.trace(gamma @ gamma).real,
        entropy=0.0,
        integration=0.0,
        differentiation=1.0,
        reflection=0.0,
        consciousness=0.0,
        stress_tensor=np.zeros(7),
        viable=True,
        margin=0.5
    )


def select_action(holon: HolonState, sigma: np.ndarray):
    """
    –í—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–Ω–∑–æ—Ä–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π.

    –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç œÉ.

    Args:
        holon: –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ì–æ–ª–æ–Ω–æ–º–∞
        sigma: –¢–µ–Ω–∑–æ—Ä –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π œÉ_sys ‚àà ‚Ñù‚Å∑

    Returns:
        Action: –î–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    """
    max_stress_idx = np.argmax(sigma)
    dimensions = ['A', 'S', 'D', 'L', 'E', 'O', 'U']

    # –í—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∏–±–æ–ª–µ–µ –Ω–∞–ø—Ä—è–∂—ë–Ω–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è
    actions = {
        0: ('reduce_articulation', '–°–Ω–∏–∑–∏—Ç—å —Ä–∞–∑–ª–∏—á–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å'),
        1: ('simplify_structure', '–£–ø—Ä–æ—Å—Ç–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É'),
        2: ('slow_dynamics', '–ó–∞–º–µ–¥–ª–∏—Ç—å –¥–∏–Ω–∞–º–∏–∫—É'),
        3: ('relax_constraints', '–û—Å–ª–∞–±–∏—Ç—å –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è'),
        4: ('focus_experience', '–°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å –æ–ø—ã—Ç'),
        5: ('reconnect_ground', '–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤—è–∑—å —Å –æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º'),
        6: ('integrate', '–£—Å–∏–ª–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é'),
    }

    return actions.get(max_stress_idx, ('wait', '–û–∂–∏–¥–∞–Ω–∏–µ'))
# margin < 0.05: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

```python
class CoherenceCyberneticsAgent:
    """
    –ê–≥–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –ö–∏–±–µ—Ä–Ω–µ—Ç–∏–∫–∏ –ö–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏.

    –†–µ–∞–ª–∏–∑—É–µ—Ç —Ü–∏–∫–ª: –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ ‚Üí —Ä–µ—Ñ–ª–µ–∫—Å–∏—è ‚Üí –¥–µ–π—Å—Ç–≤–∏–µ.
    """

    def __init__(self, config):
        self.holon = initialize_holon(config)
        self.environment = Environment(config)

    def perceive(self, observation):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Œì –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è (A-–∏–∑–º–µ—Ä–µ–Ω–∏–µ)."""
        self.holon = update_from_observation(self.holon, observation)

    def act(self) -> tuple:
        """
        –í—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ œÉ_sys.

        –°–º. definitions.md#—Ç–µ–Ω–∑–æ—Ä-–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π
        """
        sigma = compute_stress_tensor(self.holon.gamma, self.environment)
        return select_action(self.holon, sigma)

    def reflect(self):
        """
        –†–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ R.

        R = 1 - ‚ÄñŒì - œÜ(Œì)‚Äñ¬≤_F / ‚ÄñŒì‚Äñ¬≤_F
        –°–º. /docs/consciousness/foundations/self-observation#–º–µ—Ä–∞-—Ä–µ—Ñ–ª–µ–∫—Å–∏–∏-r
        """
        phi_gamma = self.holon.phi(self.holon.gamma)
        gamma_norm_sq = np.linalg.norm(self.holon.gamma, 'fro') ** 2
        self.holon.reflection = 1 - frobenius_distance(
            self.holon.gamma, phi_gamma
        ) ** 2 / gamma_norm_sq

    def is_viable(self) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏: P > P_critical.

        –°–º. /docs/core/dynamics/viability
        """
        return self.holon.purity > P_CRITICAL
```

---

**–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**
- [–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](/docs/reference/computational) ‚Äî –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `Holon`
- [–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã](/docs/reference/computational#–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ-–∞–ª–≥–æ—Ä–∏—Ç–º—ã-–∏–∑-l-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏) ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ $L_k$, $\mathcal{L}_\Omega$, $\varphi$
- [–¢–µ–æ—Ä–µ–º—ã](./theorems) ‚Äî —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è
- [–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è](./definitions) ‚Äî $\sigma_{\mathrm{sys}}$, $\mathrm{Coh}_E$, $C$
- [–ê–∫—Å–∏–æ–º–∞—Ç–∏–∫–∞](./axiomatics) ‚Äî L-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è, —Å–≤—è–∑—å $\kappa$ –∏ $\mathrm{Coh}_E$
- [–ê–∫—Å–∏–æ–º–∞ Œ©‚Å∑](/docs/core/foundations/axiom-omega) ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ $\omega_0$, $\lambda_m$
- [–≠–≤–æ–ª—é—Ü–∏—è](/docs/core/dynamics/evolution) ‚Äî —É—Ä–∞–≤–Ω–µ–Ω–∏–µ $d\Gamma/d\tau$
- [–≠–º–µ—Ä–¥–∂–µ–Ω—Ç–Ω–æ–µ –≤—Ä–µ–º—è](/docs/proofs/dynamics/emergent-time) ‚Äî –≤—ã–≤–æ–¥ œÑ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã $\Gamma$
- [–ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å](/docs/core/dynamics/viability) ‚Äî —É—Å–ª–æ–≤–∏–µ $P > P_{\text{crit}}$
- [–°–∞–º–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ](/docs/consciousness/foundations/self-observation) ‚Äî –º–µ—Ä—ã $R$, $\Phi$, $C$
- [–§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è œÜ](/docs/proofs/categorical/formalization-phi) ‚Äî CPTP-–∫–∞–Ω–∞–ª—ã
- [–ò–µ—Ä–∞—Ä—Ö–∏—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏](/docs/proofs/consciousness/interiority-hierarchy#61-–∞–ª–≥–æ—Ä–∏—Ç–º-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏-—É—Ä–æ–≤–Ω—è) ‚Äî –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
