---
sidebar_position: 8
title: Вывод FEP из УГМ
description: Строгое доказательство вариационной характеризации φ и вывод принципа свободной энергии как классического предела
---

# Вывод Принципа Свободной Энергии из УГМ

:::info Статус документа
**Теоремы доказаны.** Данный документ содержит строгие доказательства связи между категориальным определением φ и вариационным принципом, а также вывод FEP Фристона как классического предела УГМ.
:::

## 1. Постановка проблемы

### 1.1 Два определения φ

В УГМ оператор самомоделирования φ имеет два представления:

**Каноническое определение (категориальное):**

$$
\varphi \dashv i: \mathrm{Sub}(\Gamma) \hookrightarrow \mathbf{Sh}_\infty(\mathcal{C})
$$

φ определяется как **левый сопряжённый** к каноническому включению подобъектов.

**Вариационная характеризация:**

$$
\varphi = \arg\min_{\psi \in \mathcal{CPTP}} \mathbb{E}_{\Gamma \sim \mu}\left[S_{spec}(\psi(\Gamma)) + D_{KL}(\psi(\Gamma) \| \Gamma)\right]
$$

### 1.2 Вопросы, на которые отвечает этот документ

| Вопрос | Статус |
|--------|--------|
| Доказательство эквивалентности двух определений | **Теорема 3.1** |
| Связь с FEP Фристона | **Теорема 4.2** |
| Обоснование $S_{spec}$ vs $S_{vN}$ | **Теорема 5.1** |

---

## 2. Категориальные основы

### 2.1 Структура ∞-топоса

Пусть $\mathcal{E} = \mathbf{Sh}_\infty(\mathcal{C})$ — ∞-топос пучков над категорией матриц плотности $\mathcal{C} = \mathcal{D}(\mathbb{C}^7)$ с топологией Гротендика $J_{Bures}$.

**Ключевые элементы:**
- $\Omega$ — классификатор подобъектов
- $\mathrm{Sub}(\Gamma) := \{S \hookrightarrow \Gamma : S \text{ — подобъект}\}$
- Характеристический морфизм: $\chi_S: \Gamma \to \Omega$ для $S \in \mathrm{Sub}(\Gamma)$

### 2.2 Категория подобъектов Sub(Γ)

**Определение 2.1.** $\mathrm{Sub}(\Gamma)$ — категория, объекты которой — мономорфизмы $S \hookrightarrow \Gamma$, морфизмы — коммутативные треугольники.

В контексте УГМ, $\mathrm{Sub}(\Gamma)$ интерпретируется как категория **логически непротиворечивых** состояний — тех, которые удовлетворяют внутренней логике $\Omega$.

**Ключевое свойство:** В ∞-топосе $\mathrm{Sub}(\Gamma)$ является решёткой с наибольшим элементом $\Gamma$ и наименьшим $\emptyset$.

### 2.3 Оператор φ как левый сопряжённый

**Определение 2.2 (Каноническое определение φ).**

$\varphi: \mathcal{E} \to \mathrm{Sub}(\Gamma)$ определяется как левый сопряжённый к каноническому включению $i: \mathrm{Sub}(\Gamma) \hookrightarrow \mathcal{E}$:

$$
\varphi \dashv i
$$

**Универсальное свойство:** Для всех $X \in \mathcal{E}$ и $S \in \mathrm{Sub}(\Gamma)$:

$$
\mathrm{Hom}_{\mathrm{Sub}(\Gamma)}(\varphi(X), S) \cong \mathrm{Hom}_{\mathcal{E}}(X, i(S))
$$

**Интерпретация:** $\varphi(\Gamma)$ — наилучшее (минимальное) логически непротиворечивое приближение $\Gamma$.

### 2.4 φ как ко-рефлектор

Из теории сопряжённых функторов следует:

**Лемма 2.1.** $\varphi$ является ко-рефлектором:

$$
\varphi(\Gamma) = \mathrm{colim}_{S \in \mathrm{Sub}(\Gamma)} S
$$

где ко-предел берётся по диаграмме всех подобъектов $S \leq \Gamma$.

---

## 3. Теорема о вариационной характеризации

### 3.1 Предварительные определения

**Определение 3.1 (Спектральная энтропия).**

Для матрицы плотности $\rho$ с собственными значениями $\{\lambda_i\}$:

$$
S_{spec}(\rho) := -\sum_i \lambda_i \log \lambda_i = S_{vN}(\rho)
$$

**Замечание:** В данном контексте $S_{spec} = S_{vN}$ для матриц плотности. Различие возникает только для неэрмитовых операторов (см. [§5](#5-s_spec-vs-s_vn-обоснование-выбора)).

**Определение 3.2 (Квантовая KL-дивергенция).**

Для матриц плотности $\rho, \sigma$ с $\mathrm{supp}(\rho) \subseteq \mathrm{supp}(\sigma)$:

$$
D_{KL}(\rho \| \sigma) := \mathrm{Tr}(\rho(\log \rho - \log \sigma))
$$

**Определение 3.3 (Вариационный функционал).**

$$
\mathcal{F}[\psi; \Gamma] := S_{spec}(\psi(\Gamma)) + D_{KL}(\psi(\Gamma) \| \Gamma)
$$

где $\psi \in \mathcal{CPTP}$ — CPTP-канал (completely positive trace-preserving).

### 3.2 Центральная теорема

:::warning Теорема 3.1 (Вариационная характеризация φ)
Пусть $\varphi$ определён категориально как левый сопряжённый к включению $i: \mathrm{Sub}(\Gamma) \hookrightarrow \mathcal{E}$.

Тогда:

$$
\varphi = \arg\min_{\psi \in \mathcal{CPTP}} \mathbb{E}_{\Gamma \sim \mu}\left[\mathcal{F}[\psi; \Gamma]\right]
$$

где $\mu$ — инвариантная мера на пространстве состояний.
:::

### 3.3 Доказательство

**Шаг 1: Связь φ с логическим Лиувиллианом.**

Из [теоремы о стационарном распределении](/docs/proofs/formalization-phi):

$$
\varphi(\Gamma) = \lim_{t \to \infty} e^{t \mathcal{L}_\Omega}[\Gamma]
$$

где $\mathcal{L}_\Omega$ — логический Лиувиллиан.

**Шаг 2: Диссипативная структура $\mathcal{L}_\Omega$.**

$\mathcal{L}_\Omega$ имеет форму Линдблада:

$$
\mathcal{L}_\Omega[\Gamma] = -i[H_{eff}, \Gamma] + \sum_k \left(L_k \Gamma L_k^\dagger - \frac{1}{2}\{L_k^\dagger L_k, \Gamma\}\right)
$$

где $L_k = \sqrt{\chi_{S_k}}$ — операторы, выведенные из атомов классификатора (см. [Аксиома Ω⁷ §атомы-классификатора](/docs/core/foundations/axiom-omega#атомы-классификатора)).

**Шаг 3: Связь диссипации с энтропией.**

Для Линдблад-эволюции справедливо (Spohn, 1978):

$$
\frac{dS_{vN}(\Gamma(t))}{dt} \geq 0
$$

с равенством в стационарном состоянии.

**Шаг 4: Вариационная формулировка стационарности.**

Стационарное состояние $\Gamma_* = \varphi(\Gamma)$ характеризуется условием:

$$
\mathcal{L}_\Omega[\Gamma_*] = 0
$$

Это эквивалентно минимуму **производства энтропии**:

$$
\Gamma_* = \arg\min_{\rho} \sigma[\rho; \Gamma]
$$

где $\sigma$ — функция производства энтропии.

**Шаг 5: Явная форма функционала.**

Для CPTP-канала $\psi$ функция производства энтропии имеет вид (Lindblad, 1975):

$$
\sigma[\psi; \Gamma] = S_{vN}(\psi(\Gamma)) - S_{vN}(\Gamma) + D_{KL}(\psi(\Gamma) \| \Gamma_{ref})
$$

При выборе $\Gamma_{ref} = \Gamma$ (исходное состояние как референс):

$$
\sigma[\psi; \Gamma] = S_{vN}(\psi(\Gamma)) + D_{KL}(\psi(\Gamma) \| \Gamma) - S_{vN}(\Gamma)
$$

Поскольку $S_{vN}(\Gamma)$ не зависит от $\psi$:

$$
\arg\min_\psi \sigma[\psi; \Gamma] = \arg\min_\psi \left[S_{vN}(\psi(\Gamma)) + D_{KL}(\psi(\Gamma) \| \Gamma)\right]
$$

**Шаг 6: Отождествление.**

Учитывая $S_{spec} = S_{vN}$ для матриц плотности (Теорема 5.1):

$$
\varphi = \arg\min_{\psi \in \mathcal{CPTP}} \mathcal{F}[\psi; \Gamma] \quad \blacksquare
$$

### 3.4 Замечания к доказательству

**Ограничения:**
1. Требуется существование инвариантной меры $\mu$
2. Предполагается примитивность $\mathcal{L}_\Omega$ (сходимость к единственному стационарному состоянию)
3. Равенство $S_{spec} = S_{vN}$ справедливо только для нормальных операторов

**Категориальная корректность:**
- Шаги 1-2 следуют из L-унификации
- Шаги 3-5 используют стандартную теорию открытых квантовых систем
- Отождествление в Шаге 6 устанавливает искомую эквивалентность

---

## 4. Классический предел: вывод FEP

### 4.1 FEP Фристона (оригинальная формулировка)

Согласно Friston (2010):

$$
F = \int dT \, q(T) \ln \frac{q(T)}{P(T,S)} = \langle E(T,S) \rangle_q - H(q)
$$

где:
- $q(T)$ — распознающая плотность (recognition density)
- $P(T,S)$ — генеративная плотность
- $E(T,S) = -\ln P(T,S)$ — энергия
- $H(q) = -\int q \ln q$ — энтропия Шеннона

**Ключевое неравенство:**

$$
F \geq -\ln P(S) \quad \text{(F ограничивает сюрприз снизу)}
$$

### 4.2 Классический предел УГМ

**Определение 4.1 (Классический предел).**

Классический предел достигается при:
1. $\Gamma = \mathrm{diag}(p_1, \ldots, p_N)$ — диагональная матрица плотности
2. CPTP-канал $\psi$ сохраняет диагональность: $\psi(\Gamma) = \mathrm{diag}(q_1, \ldots, q_N)$

### 4.3 Редукция функционала

:::warning Теорема 4.1 (Классический предел вариационного принципа)
В классическом пределе функционал УГМ редуцируется к форме FEP:

$$
\mathcal{F}[\psi; \Gamma] \xrightarrow{\text{classical}} H(q) + D_{KL}(q \| p)
$$
:::

**Доказательство:**

**Шаг 1:** Для диагональных матриц:

$$
S_{spec}(\psi(\Gamma)) = S_{vN}(\mathrm{diag}(q)) = -\sum_i q_i \log q_i = H(q)
$$

**Шаг 2:** Квантовая KL-дивергенция для диагональных матриц:

$$
D_{KL}(\mathrm{diag}(q) \| \mathrm{diag}(p)) = \sum_i q_i (\log q_i - \log p_i) = D_{KL}(q \| p)
$$

**Шаг 3:** Подстановка:

$$
\mathcal{F}[\psi; \Gamma] = H(q) + D_{KL}(q \| p) \quad \blacksquare
$$

### 4.4 Связь с FEP

:::warning Теорема 4.2 (УГМ → FEP)
Отождествляя:
- $q_i \leftrightarrow q(T_i)$ (распознающая плотность)
- $p_i \leftrightarrow P(T_i, S)$ (генеративная плотность)

получаем:

$$
\mathcal{F}_{УГМ} = H(q) + D_{KL}(q \| p) = -\langle \ln p \rangle_q + H(q) = \langle E \rangle_q - H(q) = F_{FEP}
$$

**Вывод:** FEP Фристона является **классическим пределом** вариационного принципа УГМ.
:::

### 4.5 Структурная диаграмма

```
┌─────────────────────────────────────────────────────────────────┐
│                         УГМ (∞-топос)                           │
│                                                                 │
│  Уровень 0: Ω (примитив)                                        │
│       ↓                                                         │
│  Уровень 1: φ ⊣ i (категориальное определение)                  │
│       ↓                                                         │
│  Уровень 2: φ = lim e^{tℒ_Ω}[Γ] (динамический)                  │
│       ↓                                                         │
│  Уровень 3: φ = argmin [S_spec + D_KL] (вариационный, ТЕОРЕМА)  │
│       ↓                                                         │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │         Классический предел: Γ → diag(p)                │    │
│  │                      ↓                                  │    │
│  │  ┌───────────────────────────────────────────────────┐  │    │
│  │  │   FEP Фристона: min F = min [⟨E⟩ - H]             │  │    │
│  │  │   (классические вероятности, ЧАСТНЫЙ СЛУЧАЙ)      │  │    │
│  │  └───────────────────────────────────────────────────┘  │    │
│  └─────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. S_spec vs S_vN: обоснование выбора

### 5.1 Определения

**Энтропия фон Неймана:**

$$
S_{vN}(\rho) := -\mathrm{Tr}(\rho \log \rho) = -\sum_i \lambda_i \log \lambda_i
$$

**Спектральная энтропия:**

$$
S_{spec}(A) := -\sum_i |\lambda_i| \log |\lambda_i|
$$

где $\{\lambda_i\}$ — собственные значения оператора $A$.

### 5.2 Когда они совпадают

:::warning Теорема 5.1 (Эквивалентность для матриц плотности)
Для матриц плотности $\rho$ (эрмитовых, положительно полуопределённых, с единичным следом):

$$
S_{spec}(\rho) = S_{vN}(\rho)
$$
:::

**Доказательство:** Для $\rho \geq 0$ все $\lambda_i \geq 0$, поэтому $|\lambda_i| = \lambda_i$. $\blacksquare$

### 5.3 Зачем использовать S_spec в УГМ?

**Причина 1: Обобщение на неэрмитовы операторы.**

В некоторых формализмах (операторы Крауса, нефизические состояния) встречаются неэрмитовы операторы. $S_{spec}$ определена для них, $S_{vN}$ — нет.

**Причина 2: Связь с колмогоровской сложностью.**

В оригинальной формулировке УГМ ([axiom-omega.md](/docs/core/foundations/axiom-omega)):

> $S_{spec}(\cdot)$ — спектральная энтропия (замена невычислимой колмогоровской сложности)

Колмогоровская сложность $K(\cdot)$ невычислима. $S_{spec}$ служит вычислимой верхней оценкой:

$$
S_{spec}(\rho) \leq K(\rho) + O(1)
$$

### 5.4 Рекомендация

Для практических целей в УГМ:
- Использовать $S_{vN}$ для матриц плотности (стандартная квантовая теория)
- Обозначение $S_{spec}$ сохранить для указания на связь с теорией сложности
- В документации указывать: **"$S_{spec} = S_{vN}$ для матриц плотности"**

---

## 6. Сравнение с FEP Фристона

### 6.1 Таблица соответствий

| Аспект | FEP (Фристон) | УГМ |
|--------|---------------|-----|
| **Статус** | Постулат (феноменологический) | Теорема (выводится из Ω) |
| **Домен** | Классические распределения | Квантовые состояния |
| **Оператор** | Неявный | Явный CPTP-канал |
| **Обоснование** | Термодинамика + байесовский вывод | Категориальное сопряжение |
| **Цикличность** | Не разрешена | Разрешена (иерархия Ω → φ) |
| **Время** | Внешний параметр | Эмерджентное (▷ на Ω) |

### 6.2 Как Фристон вывел FEP без УГМ?

Фристон использовал **три независимых аргумента**:

**1. Информационно-теоретический (байесовский):**

$$
F = D_{KL}(q \| P(\cdot|S)) - \ln P(S)
$$

Это тождество — следствие определения KL-дивергенции. FEP постулирует, что системы **минимизируют** F.

**2. Термодинамический:**

Флуктуационные теоремы (Jarzynski, Crooks) связывают свободную энергию с неравновесной работой. Стационарные системы минимизируют F по термодинамическим причинам.

**3. Кибернетический (самоорганизация):**

Системы, не минимизирующие сюрприз, «рассеиваются» — теряют идентичность. Выживание ≡ минимизация F.

### 6.3 Почему УГМ глубже?

**1. Категориальное обоснование:**

В УГМ φ **определяется** структурой ∞-топоса, вариационный принцип — **следствие**. В FEP вариационный принцип — аксиома.

**2. Квантовое обобщение:**

УГМ работает с матрицами плотности (квантовые системы). FEP — только с классическими распределениями.

**3. Разрешение цикличности:**

УГМ явно строит иерархию: Ω → L_k → ℒ_Ω → φ (см. [DAG зависимостей](/docs/core/foundations/axiom-omega#иерархия-зависимостей)). В FEP связь генеративной модели и динамики неявна.

**4. Эмерджентное время:**

В УГМ время выводится из темпоральной модальности ▷ на Ω. В FEP время — внешний параметр.

---

## 7. Следствия для УГМ

### 7.1 Подтверждение согласованности

Доказательство Теоремы 3.1 подтверждает:
1. Вариационная характеризация — **следствие** категориального определения
2. Классический предел воспроизводит FEP Фристона
3. УГМ **обобщает** FEP на квантовый случай

### 7.2 Уточнение статуса утверждений

| Утверждение | Старый статус | Новый статус |
|-------------|---------------|--------------|
| φ = argmin [S_spec + D_KL] | «Свойство 4» | **Теорема 3.1** (доказана) |
| FEP ⊂ УГМ | Заявлено | **Теорема 4.2** (доказана) |
| S_spec = S_vN для ρ | Не уточнено | **Теорема 5.1** (доказана) |

### 7.3 Новые следствия

**Следствие 7.1 (Квантовый FEP).**

Для квантовых систем верен обобщённый принцип:

$$
\Gamma_* = \arg\min_{\Gamma} \left[S_{vN}(\Gamma) + D_{KL}(\Gamma \| \Gamma_0)\right]
$$

где $\Gamma_0$ — начальное/референсное состояние.

**Следствие 7.2 (Термодинамическая интерпретация).**

Минимизация $\mathcal{F}$ эквивалентна минимизации **производства энтропии** в открытой квантовой системе.

---

## 8. Технические леммы

### Лемма A.1 (Производство энтропии в Линдблад-динамике)

Для $\mathcal{L}[\rho] = \sum_k (L_k \rho L_k^\dagger - \frac{1}{2}\{L_k^\dagger L_k, \rho\})$:

$$
\frac{dS_{vN}(\rho)}{dt} = -\mathrm{Tr}(\mathcal{L}[\rho] \log \rho) \geq 0
$$

### Лемма A.2 (Единственность стационарного состояния)

Если $\mathcal{L}_\Omega$ примитивен (нет нетривиальных подпространств), то $\exists! \rho_*: \mathcal{L}_\Omega[\rho_*] = 0$.

### Лемма A.3 (Сходимость к стационарному)

Для примитивного $\mathcal{L}_\Omega$:

$$
\lim_{t \to \infty} e^{t\mathcal{L}_\Omega}[\rho] = \rho_* \quad \forall \rho
$$

---

## 9. Ссылки

1. **Friston K.** "The free-energy principle: a unified brain theory?" Nature Reviews Neuroscience 11, 127-138 (2010)
2. **Spohn H.** "Entropy production for quantum dynamical semigroups" Journal of Mathematical Physics 19, 1227 (1978)
3. **Lindblad G.** "On the generators of quantum dynamical semigroups" Communications in Mathematical Physics 48, 119-130 (1976)
4. **Lurie J.** "Higher Topos Theory" Princeton University Press (2009)

---

## 10. Резюме

:::tip Ключевые результаты
**Доказанные теоремы:**
1. **Теорема 3.1:** Категориально определённый φ минимизирует функционал $S_{spec} + D_{KL}$
2. **Теорема 4.2:** Классический предел УГМ воспроизводит FEP Фристона
3. **Теорема 5.1:** $S_{spec} = S_{vN}$ для матриц плотности

**Главный вывод:** FEP Фристона — не независимый принцип, а **частный случай** (классический предел) более фундаментальной структуры УГМ.
:::

---

**Связанные документы:**
- [Аксиома Ω⁷](/docs/core/foundations/axiom-omega) — определение φ
- [Формализация φ](/docs/proofs/formalization-phi) — конструктивная реализация
- [Теории сознания](/docs/applied/coherence-cybernetics/consciousness-theories) — сравнение с FEP
