---
slug: /reference/computational
sidebar_position: 5
title: –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
description: Python-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ì–æ–ª–æ–Ω–æ–º–∞
---

# –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

:::note –û –Ω–æ—Ç–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ
–í Python-–∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è:
- `Gamma` ($\Gamma$) ‚Äî [–º–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏](/docs/core/dynamics/coherence-matrix)
- `H` ‚Äî [–≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω](/docs/core/dynamics/evolution#1-—É–Ω–∏—Ç–∞—Ä–Ω—ã–π-—á–ª–µ–Ω)
- `L` ($L_k$) ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞
- `purity` ($P$) ‚Äî [–º–µ—Ä–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏](/docs/core/dynamics/viability#–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ-—á–∏—Å—Ç–æ—Ç—ã)
- `d_FS` ($d_{\mathrm{FS}}$) ‚Äî [–º–µ—Ç—Ä–∏–∫–∞ –§—É–±–∏–Ω–∏-–®—Ç—É–¥–∏](/docs/reference/specification#–º–µ—Ç—Ä–∏–∫–∞-—Ñ—É–±–∏–Ω–∏-—à—Ç—É–¥–∏)
- `kappa_0` ($\kappa_0$) ‚Äî [–±–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏](/docs/core/foundations/axiom-septicity#–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π-–≤—ã–≤–æ–¥-kappa0) (–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥)
- `P_CRIT` ($P_{\text{crit}} = 2/7$) ‚Äî [–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞](/docs/proofs/dynamics/theorem-purity-critical)
:::

:::warning –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
–î–∞–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—É—é —ç–≤–æ–ª—é—Ü–∏—é —Å —Ç—Ä–µ–º—è —á–ª–µ–Ω–∞–º–∏, –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç:
1. **–ú–µ—Ä—ã —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** $R$, $\Phi$, $D_{\text{diff}}$, $C$ ‚Äî —Å–º. [–°–∞–º–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ](/docs/consciousness/foundations/self-observation)
2. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Ä–æ–≤–Ω–µ–π** L0/L1/L2/L3/L4 ‚Äî —Å–º. [–ò–µ—Ä–∞—Ä—Ö–∏—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏](/docs/proofs/consciousness/interiority-hierarchy)
3. **–û–ø–µ—Ä–∞—Ç–æ—Ä —Å–∞–º–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è** $\varphi$ ‚Äî —Å–º. [–§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è œÜ](/docs/proofs/categorical/formalization-phi)
4. **–†–µ—Ñ–ª–µ–∫—Å–∏—è –≤—ã—Å—à–∏—Ö –ø–æ—Ä—è–¥–∫–æ–≤** $R^{(n)}$ ‚Äî —Å–º. [–†–µ—Ñ–ª–µ–∫—Å–∏—è –≤—ã—Å—à–∏—Ö –ø–æ—Ä—è–¥–∫–æ–≤](/docs/proofs/categorical/formalization-phi#28-—Ä–µ—Ñ–ª–µ–∫—Å–∏—è-n-–≥–æ-–ø–æ—Ä—è–¥–∫–∞-–¥–ª—è-l3l4)

–î–ª—è –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–º. [–ò–µ—Ä–∞—Ä—Ö–∏—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏: –ê–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏](/docs/proofs/consciousness/interiority-hierarchy#61-–∞–ª–≥–æ—Ä–∏—Ç–º-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏-—É—Ä–æ–≤–Ω—è).
:::

:::info –ì–∞—Ä–∞–Ω—Ç–∏—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
–ù–µ–ª–∏–Ω–µ–π–Ω—ã–π —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —á–ª–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å $\Gamma \geq 0$ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ $\alpha = \kappa \cdot \Delta\tau < 1$. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —à–∞–≥–∞ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ —ç—Ç–æ–≥–æ —É—Å–ª–æ–≤–∏—è. –°–º. [—Ç–µ–æ—Ä–µ–º—É –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏](/docs/core/dynamics/evolution#—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏).
:::

## –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π –£–ì–ú

:::info –ê—Å–∏–º–ø—Ç–æ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ü–µ–Ω–∫–∏
–í—Å–µ –æ—Ü–µ–Ω–∫–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã $\Gamma \in \mathbb{C}^{N \times N}$. –î–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ì–æ–ª–æ–Ω–æ–º–∞ $N = 7$.
:::

| –û–ø–µ—Ä–∞—Ü–∏—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –§–æ—Ä–º—É–ª–∞ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|---|---|---|---|
| –ß–∏—Å—Ç–æ—Ç–∞ $P = \mathrm{Tr}(\Gamma^2)$ | $O(N^3)$ | –£–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü + —Å–ª–µ–¥ | –î–æ–º–∏–Ω–∏—Ä—É–µ—Ç $\Gamma^2$ |
| –ù–æ—Ä–º–∞ –§—Ä–æ–±–µ–Ω–∏—É—Å–∞ $\|\Gamma\|_F$ | $O(N^2)$ | $\sqrt{\sum_{ij} \|\gamma_{ij}\|^2}$ | –°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ |
| –≠–Ω—Ç—Ä–æ–ø–∏—è $S_{vN} = -\mathrm{Tr}(\Gamma \log \Gamma)$ | $O(N^3)$ | –î–∏–∞–≥–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è | –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è |
| –û–ø–µ—Ä–∞—Ç–æ—Ä $\varphi(\Gamma)$ | $O(M \cdot N^3)$ | $\sum_m K_m \Gamma K_m^\dagger$ | $M$ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –ö—Ä–∞—É—Å–∞ |
| –†–µ—Ñ–ª–µ–∫—Å–∏—è $R$ | $O(M \cdot N^3)$ | $1 - \|\Gamma - \varphi(\Gamma)\|_F^2 / \|\Gamma\|_F^2$ | –î–æ–º–∏–Ω–∏—Ä—É–µ—Ç $\varphi(\Gamma)$ |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è $\Phi$ | $O(N^2)$ | $\sum_{i \neq j} \|\gamma_{ij}\|^2 / \sum_i \gamma_{ii}^2$ | –°—É–º–º—ã –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º |
| –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—è $D_{\text{diff}}$ | $O(N^3)$ | $\exp(S_{vN}(\rho_E))$ | –¢—Ä–µ–±—É–µ—Ç —ç–Ω—Ç—Ä–æ–ø–∏–∏ |
| –°–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $C = \Phi \cdot D \cdot R$ | $O(M \cdot N^3)$ | –ö–æ–º–ø–æ–∑–∏—Ü–∏—è | –î–æ–º–∏–Ω–∏—Ä—É–µ—Ç $R$ |
| –û–¥–∏–Ω —à–∞–≥ $d\Gamma/d\tau$ | $O(N^3)$ | –£–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü | –£–Ω–∏—Ç–∞—Ä–Ω–∞—è + –¥–∏—Å—Å–∏–ø–∞—Ü–∏—è |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ $P > P_{\text{crit}}$ | $O(N^3)$ | –í—ã—á–∏—Å–ª–µ–Ω–∏–µ $P$ | –û–¥–∏–Ω –≤—ã–∑–æ–≤ |
| –ú–µ—Ç—Ä–∏–∫–∞ $d_{\mathrm{FS}}$ | $O(N)$ | $\arccos(\|\langle\psi\|\phi\rangle\|)$ | –°–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ |

**–î–ª—è $N = 7$, $M = 7$:**

$$
O(M \cdot N^3) = O(7 \cdot 343) = O(2401) \approx O(1)
$$

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—ã –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏.

**–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è $N > 7$:**

- **–£–∑–∫–æ–µ –º–µ—Å—Ç–æ:** –º–∞—Ç—Ä–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ $O(N^3)$
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏ $\|\gamma_{ij}\| \ll 1$ –¥–ª—è $i \neq j$
- **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è:** GPU-—É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è $N > 100$

:::warning –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
–ü—Ä–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ –Ω–∞ –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã $\mathbb{H}_{1 \otimes \cdots \otimes n}$ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞—Å—Ç—ë—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ: $N = 7^n$. –î–ª—è $n = 3$: $N = 343$, —á—Ç–æ —É–∂–µ —Ç—Ä–µ–±—É–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.
:::

## –ö–ª–∞—Å—Å Holon

```python
import numpy as np
from scipy.linalg import expm

class Holon:
    """
    –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ì–æ–ª–æ–Ω–æ–º–∞ –∏–∑ —Ç–µ–æ—Ä–∏–∏ –£–ì–ú.

    –ì–æ–ª–æ–Ω–æ–º ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏,
    –æ–ø–∏—Å—ã–≤–∞–µ–º–∞—è 7-–º–µ—Ä–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ Œì ‚àà C^{7√ó7}.

    –≠–≤–æ–ª—é—Ü–∏—è –ì–æ–ª–æ–Ω–æ–º–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω—ã–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º:

        dŒì/dœÑ = -i[H_eff, Œì] + D[Œì] + R[Œì, E]

    –≥–¥–µ:
        - -i[H_eff, Œì] : —É–Ω–∏—Ç–∞—Ä–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è (–≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω)
        - D[Œì]         : –¥–∏—Å—Å–∏–ø–∞—Ü–∏—è (—É—Ä–∞–≤–Ω–µ–Ω–∏–µ –õ–∏–Ω–¥–±–ª–∞–¥–∞)
        - R[Œì, E]      : —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–≤—è–∑—å —Å –û—Å–Ω–æ–≤–∞–Ω–∏–µ–º

    –†–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —á–ª–µ–Ω [–¢] (–ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–≤–µ–¥–µ–Ω –∏–∑ –∞–∫—Å–∏–æ–º):
        R[Œì, E] = Œ∫(Œì) ¬∑ (œÅ* - Œì) ¬∑ Œò(ŒîF)

    –≥–¥–µ —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
        Œ∫(Œì) = Œ∫_bootstrap + Œ∫‚ÇÄ ¬∑ Coh_E(Œì)
        Œ∫_bootstrap = ‚ÄñŒ∑‚Äñ > 0 (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ –µ–¥–∏–Ω–∏—Ü—ã —Å–æ–ø—Ä—è–∂–µ–Ω–∏—è,
                              —Ç—Ä–µ–±—É–µ—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã)
        Œ∫‚ÇÄ = œâ‚ÇÄ ¬∑ |Œ≥_OE| ¬∑ |Œ≥_OU| / Œ≥_OO

    –ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —á–∏—Å—Ç–æ—Ç–æ–π P_crit = 2/7 ‚âà 0.286.
    """

    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞ ‚Äî –ø–æ—Ä–æ–≥ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
    P_CRIT = 2/7  # ‚âà 0.2857

    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è: Œ∫_bootstrap = œâ‚ÇÄ/N –≥–¥–µ N=7
    # –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥: /docs/core/foundations/axiom-septicity#—Ç–µ–æ—Ä–µ–º–∞-kappa-bootstrap
    # –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è œâ‚ÇÄ=1: Œ∫_bootstrap = 1/7 ‚âà 0.143
    KAPPA_BOOTSTRAP = 1/7  # ‚âà 0.143 ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ —Å —Ç–µ–æ—Ä–µ–º–æ–π –ø—Ä–∏ œâ‚ÇÄ=1

    def __init__(self, pure=True, omega_0=1.0):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ì–æ–ª–æ–Ω–æ–º–∞.

        Args:
            pure: True –¥–ª—è —á–∏—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (P=1), False –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ
            omega_0: –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ —á–∞—Å–æ–≤ (–º–∞—Å—à—Ç–∞–± Œ∫‚ÇÄ)
        """
        if pure:
            # –ß–∏—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: |œà‚ü© = (1/‚àö7) Œ£|i‚ü©
            psi = np.ones(7, dtype=complex) / np.sqrt(7)
            self.Gamma = np.outer(psi, psi.conj())
        else:
            # –°–º–µ—à–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é –•–æ–ª–µ—Ü–∫–æ–≥–æ
            self._L_cholesky = np.eye(7, dtype=complex)
            self._update_gamma_from_L()

        # –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ –¥–ª—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        self.omega_0 = omega_0

        # –¶–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥–æ–º set_target_state)
        self.Gamma_target = None

        # –ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω —Å–∏—Å—Ç–µ–º—ã
        self.H = self._build_hamiltonian()

        # –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏–∏
        self.L = self._build_lindblad_operators()

    def _update_gamma_from_L(self):
        """
        Œì = L¬∑L‚Ä† / Tr(L¬∑L‚Ä†) ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Œì ‚â• 0 –∏ Tr(Œì) = 1.
        """
        G = self._L_cholesky @ self._L_cholesky.conj().T
        self.Gamma = G / np.trace(G)

    def _build_hamiltonian(self):
        """
        –°—Ç—Ä–æ–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –≥–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω —Å–∏—Å—Ç–µ–º—ã H_eff.

        –°—Ç—Ä—É–∫—Ç—É—Ä–∞: –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–æ—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π,
        –≤–Ω–µ–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ ‚Äî —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏ (–∫–æ–ª—å—Ü–µ–≤–∞—è —Ç–æ–ø–æ–ª–æ–≥–∏—è).
        """
        H = np.zeros((7, 7), dtype=complex)

        # –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–æ—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π (A, S, D, L, E, O, U)
        frequencies = [1.0, 0.8, 1.2, 0.9, 1.1, 0.7, 1.0]
        for i, w in enumerate(frequencies):
            H[i, i] = w

        # –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏
        coupling = 0.1
        for i in range(6):
            H[i, i+1] = coupling
            H[i+1, i] = coupling
        H[6, 0] = coupling  # –ó–∞–º—ã–∫–∞–Ω–∏–µ –∫–æ–ª—å—Ü–∞
        H[0, 6] = coupling

        return H

    def _build_lindblad_operators(self):
        """
        –°—Ç—Ä–æ–∏—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞ L_k –¥–ª—è –¥–∏—Å—Å–∏–ø–∞—Ç–∏–≤–Ω–æ–π —á–∞—Å—Ç–∏ D[Œì].

        D[Œì] = Œ£_k (L_k Œì L_k‚Ä† - ¬Ω{L_k‚Ä†L_k, Œì})

        –ü—Ä–æ—Å—Ç–µ–π—à–∞—è –º–æ–¥–µ–ª—å: –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏—è —Å —Ä–∞–≤–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é.
        """
        L = []
        gamma = 0.01  # –°–∫–æ—Ä–æ—Å—Ç—å –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏–∏
        for i in range(7):
            L_i = np.zeros((7, 7), dtype=complex)
            L_i[i, i] = np.sqrt(gamma)
            L.append(L_i)
        return L

    def compute_kappa_0(self):
        """
        –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Œ∫‚ÇÄ.

        Œ∫‚ÇÄ = œâ‚ÇÄ ¬∑ |Œ≥_OE| ¬∑ |Œ≥_OU| / Œ≥_OO

        –§–∏–∑–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª: —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–≤—è–∑—å—é
        –∏–∑–º–µ—Ä–µ–Ω–∏—è –û—Å–Ω–æ–≤–∞–Ω–∏—è (O) —Å –ò–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç—å—é (E) –∏ –ï–¥–∏–Ω—Å—Ç–≤–æ–º (U).

        –ò–Ω–¥–µ–∫—Å—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π (0-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è):
            A=0, S=1, D=2, L=3, E=4, O=5, U=6

        Returns:
            Œ∫‚ÇÄ ‚â• 0 ‚Äî –±–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        """
        O, E, U = 5, 4, 6  # –ò–Ω–¥–µ–∫—Å—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π

        gamma_OO = np.real(self.Gamma[O, O])
        gamma_OE = np.abs(self.Gamma[O, E])
        gamma_OU = np.abs(self.Gamma[O, U])

        if gamma_OO < 1e-12:
            return 0.0  # –°–∏—Å—Ç–µ–º–∞ –ø–æ—Ç–µ—Ä—è–ª–∞ —Å–≤—è–∑—å —Å –û—Å–Ω–æ–≤–∞–Ω–∏–µ–º

        return self.omega_0 * gamma_OE * gamma_OU / gamma_OO

    def compute_e_coherence(self):
        """
        E-–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å (HS-–ø—Ä–æ–µ–∫—Ü–∏—è œÄ_E, [–¢]): Coh_E(Œì) = ‚ÄñœÄ_E(Œì)‚Äñ¬≤_HS / ‚ÄñŒì‚Äñ¬≤_HS = (Œ≥_EE¬≤ + 2¬∑Œ£_{i‚â†E}|Œ≥_Ei|¬≤) / Tr(Œì¬≤).

        –ú–∞—Å—Ç–µ—Ä-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: Coh_E := Tr(œÅ_E¬≤), –≥–¥–µ œÅ_E = Tr_{-E}(Œì).
        –í –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º 7D-—Ñ–æ—Ä–º–∞–ª–∏–∑–º–µ œÄ_E ‚Äî –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è
        –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ì–∏–ª—å–±–µ—Ä—Ç–∞-–®–º–∏–¥—Ç–∞ –Ω–∞ E-–ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.
        –ú–Ω–æ–∂–∏—Ç–µ–ª—å 2 —Å–ª–µ–¥—É–µ—Ç –∏–∑ —ç—Ä–º–∏—Ç–æ–≤–æ–π —Å–∏–º–º–µ—Ç—Ä–∏–∏: |Œ≥_Ei|¬≤ = |Œ≥_iE|¬≤.

        –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Tr(Œì¬≤) –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç Coh_E ‚àà [1/7, 1].

        –°–º. /docs/applied/coherence-cybernetics/definitions#e-–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å

        Returns:
            Coh_E ‚àà [1/7, 1] ‚Äî –º–µ—Ä–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –æ–ø—ã—Ç–∞
        """
        E = 4  # –ò–Ω–¥–µ–∫—Å –∏–∑–º–µ—Ä–µ–Ω–∏—è Experience

        # –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç E (–∫–≤–∞–¥—Ä–∞—Ç)
        gamma_EE_sq = np.real(self.Gamma[E, E])**2

        # –°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–µ–π E —Å –¥—Ä—É–≥–∏–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏
        coherence_sum = 0.0
        for i in range(7):
            if i != E:
                coherence_sum += np.abs(self.Gamma[E, i])**2

        # Coh_E = (Œ≥_EE¬≤ + 2¬∑Œ£_{i‚â†E}|Œ≥_Ei|¬≤) / Tr(Œì¬≤)
        purity = np.real(np.trace(self.Gamma @ self.Gamma))
        if purity < 1e-12:
            return 1/7
        raw_coh_e = (gamma_EE_sq + 2 * coherence_sum) / purity

        return np.clip(raw_coh_e, 1/7, 1.0)

    def set_target_state(self, Gamma_target=None):
        """
        –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ü–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ œÅ* (Gamma_target) –¥–ª—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

        –í –ø–æ–ª–Ω–æ–π —Ç–µ–æ—Ä–∏–∏ œÅ* = œÜ(Œì) ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        L_Œ© (–ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ—Å—Ç—å [–¢]). –§–æ—Ä–º–∞ ‚Ñõ = Œ∫¬∑(œÅ*‚àíŒì)¬∑Œò(ŒîF) –ø–æ–ª–Ω–æ—Å—Ç—å—é
        –≤—ã–≤–µ–¥–µ–Ω–∞ –∏–∑ –∞–∫—Å–∏–æ–º [–¢]. –í —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —è–≤–Ω–æ.

        Args:
            Gamma_target: –¶–µ–ª–µ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
                         –ï—Å–ª–∏ None, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
        """
        if Gamma_target is None:
            self.Gamma_target = self.Gamma.copy()
        else:
            self.Gamma_target = Gamma_target

    def _compute_regeneration(self, delta_F, dtau):
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —á–ª–µ–Ω R[Œì, E].

        R[Œì, E] = Œ∫(Œì) ¬∑ (Œì_target - Œì) ¬∑ Œò(ŒîF)

        –≥–¥–µ:
            Œ∫(Œì) = Œ∫_bootstrap + Œ∫‚ÇÄ ¬∑ Coh_E(Œì)
            Œò(ŒîF) = 1 –µ—Å–ª–∏ ŒîF > 0, –∏–Ω–∞—á–µ 0 (—Ñ—É–Ω–∫—Ü–∏—è –•–µ–≤–∏—Å–∞–π–¥–∞)

        Œ∫_bootstrap > 0 –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–∏ –ª—é–±–æ–º Coh_E,
        —Ä–∞–∑—Ä–µ—à–∞—è bootstrap-–ø–∞—Ä–∞–¥–æ–∫—Å (—Å–º. Genesis Protocol).

        Args:
            delta_F: –ì—Ä–∞–¥–∏–µ–Ω—Ç —Å–≤–æ–±–æ–¥–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏ (>0 –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é)
            dtau: –í—Ä–µ–º–µ–Ω–Ω–æ–π —à–∞–≥ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –≤—Ä–µ–º—è œÑ)

        Returns:
            dŒì_regen: –í–∫–ª–∞–¥ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ –∏–∑–º–µ–Ω–µ–Ω–∏–µ Œì
        """
        # Œò(ŒîF): —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–µ
        if delta_F <= 0 or self.Gamma_target is None:
            return np.zeros_like(self.Gamma)

        # Œ∫(Œì) = Œ∫_bootstrap + Œ∫‚ÇÄ ¬∑ Coh_E(Œì)
        kappa_0 = self.compute_kappa_0()
        coh_E = self.compute_e_coherence()
        kappa = self.KAPPA_BOOTSTRAP + kappa_0 * coh_E

        # –£—Å–ª–æ–≤–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏: Œ± = Œ∫¬∑dœÑ < 1 –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        # –°–º. —Ç–µ–æ—Ä–µ–º—É –æ CPTP-—Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ evolution.md
        alpha = kappa * dtau
        if alpha >= 1.0:
            # –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —à–∞–≥ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            dtau = 0.9 / kappa  # Œ± = 0.9 < 1
            alpha = kappa * dtau

        # R[Œì, E] = Œ∫ ¬∑ (Œì_target - Œì)
        return kappa * (self.Gamma_target - self.Gamma) * dtau

    def evolve(self, dtau, delta_F=0.0):
        """
        –ü–æ–ª–Ω—ã–π —à–∞–≥ —ç–≤–æ–ª—é—Ü–∏–∏ –ø–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—é –£–ì–ú.

        dŒì/dœÑ = -i[H_eff, Œì] + D[Œì] + R[Œì, E]

        –¢—Ä–∏ —á–ª–µ–Ω–∞:
            1. –£–Ω–∏—Ç–∞—Ä–Ω—ã–π: -i[H_eff, Œì] ‚Äî –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è
            2. –î–∏—Å—Å–∏–ø–∞—Ç–∏–≤–Ω—ã–π: D[Œì] ‚Äî –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏—è (—É—Ä–∞–≤–Ω–µ–Ω–∏–µ –õ–∏–Ω–¥–±–ª–∞–¥–∞)
            3. –†–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–π: R[Œì, E] ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –û—Å–Ω–æ–≤–∞–Ω–∏–µ

        Args:
            dtau: –í—Ä–µ–º–µ–Ω–Ω–æ–π —à–∞–≥ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –≤—Ä–µ–º—è œÑ)
            delta_F: –ì—Ä–∞–¥–∏–µ–Ω—Ç —Å–≤–æ–±–æ–¥–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏ (>0 –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é)
        """
        # 1. –£–Ω–∏—Ç–∞—Ä–Ω–∞—è —á–∞—Å—Ç—å: -i[H, Œì]
        U = expm(-1j * self.H * dtau)
        self.Gamma = U @ self.Gamma @ U.conj().T

        # 2. –î–∏—Å—Å–∏–ø–∞—Ç–∏–≤–Ω–∞—è —á–∞—Å—Ç—å: D[Œì] (—É—Ä–∞–≤–Ω–µ–Ω–∏–µ –õ–∏–Ω–¥–±–ª–∞–¥–∞)
        for L_k in self.L:
            self.Gamma += dtau * (
                L_k @ self.Gamma @ L_k.conj().T
                - 0.5 * L_k.conj().T @ L_k @ self.Gamma
                - 0.5 * self.Gamma @ L_k.conj().T @ L_k
            )

        # 3. –†–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–∞—è —á–∞—Å—Ç—å: R[Œì, E]
        self.Gamma += self._compute_regeneration(delta_F, dtau)

        # –ü–µ—Ä–µ–Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∞ –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
        self.Gamma /= np.trace(self.Gamma)

    def compute_purity(self):
        """
        –í—ã—á–∏—Å–ª—è–µ—Ç —á–∏—Å—Ç–æ—Ç—É P = Tr(Œì¬≤).

        Returns:
            P ‚àà [1/7, 1] ‚Äî –º–µ—Ä–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏
        """
        return np.real(np.trace(self.Gamma @ self.Gamma))

    def compute_entropy(self):
        """
        –≠–Ω—Ç—Ä–æ–ø–∏—è —Ñ–æ–Ω –ù–µ–π–º–∞–Ω–∞ S = -Tr(Œì log Œì).

        Returns:
            S ‚àà [0, log(7)] ‚Äî –º–µ—Ä–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏
        """
        eigvals = np.linalg.eigvalsh(self.Gamma)
        eigvals = eigvals[eigvals > 1e-12]  # –ò–∑–±–µ–≥–∞–µ–º log(0)
        return -np.sum(eigvals * np.log(eigvals))

    def get_exp(self):
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–µ–∫—Ç—Ä –æ–ø—ã—Ç–∞ (–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ —ç–∫—Å–ø–µ—Ä–∏–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è).

        Returns:
            –ú–∞—Å—Å–∏–≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ —É–±—ã–≤–∞–Ω–∏—é
        """
        eigenvalues = np.linalg.eigvalsh(self.Gamma)
        return np.sort(eigenvalues)[::-1]

    def get_full_exp(self):
        """
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω–æ–µ —ç–∫—Å–ø–µ—Ä–∏–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ: (–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å, –∫–∞—á–µ—Å—Ç–≤–æ).

        –ö–∞—á–µ—Å—Ç–≤–æ = —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –≤ –ø—Ä–æ–µ–∫—Ç–∏–≤–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ ‚Ñô(‚Ñã).
        –ü—Ä–∏–º–µ–Ω–∏–º–æ –¥–ª—è –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π L0-L2.

        Returns:
            –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å intensity, quality, quality_class
        """
        eigenvalues, eigenvectors = np.linalg.eigh(self.Gamma)
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        idx = np.argsort(eigenvalues)[::-1]
        eigenvalues = eigenvalues[idx]
        eigenvectors = eigenvectors[:, idx]

        exp_contents = []
        for i in range(len(eigenvalues)):
            intensity = eigenvalues[i]
            quality = eigenvectors[:, i]
            # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–æ –µ–¥–∏–Ω–∏—á–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞
            quality = quality / np.linalg.norm(quality)
            exp_contents.append({
                'intensity': float(np.real(intensity)),
                'quality': quality,
                'quality_class': self._to_projective(quality)
            })
        return exp_contents

    def _to_projective(self, vector):
        """
        –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç–∏–≤–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.

        –í—ã–±–∏—Ä–∞–µ–º —Ñ–∞–∑—É —Ç–∞–∫, —á—Ç–æ–±—ã –ø–µ—Ä–≤—ã–π –Ω–µ–Ω—É–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç
        –±—ã–ª –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º.
        """
        for i, v in enumerate(vector):
            if np.abs(v) > 1e-10:
                phase = np.exp(-1j * np.angle(v))
                return vector * phase
        return vector

    @staticmethod
    def fubini_study_distance(v1, v2):
        """
        –ú–µ—Ç—Ä–∏–∫–∞ –§—É–±–∏–Ω–∏-–®—Ç—É–¥–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –∫–∞—á–µ—Å—Ç–≤–∞–º–∏.

        d_FS([|œà‚ü©], [|œÜ‚ü©]) = arccos(|‚ü®œà|œÜ‚ü©|) ‚àà [0, œÄ/2]

        Args:
            v1, v2: –≤–µ–∫—Ç–æ—Ä—ã –≤ ‚Ñã

        Returns:
            –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ d_FS ‚àà [0, œÄ/2]
        """
        v1 = v1 / np.linalg.norm(v1)
        v2 = v2 / np.linalg.norm(v2)
        overlap = np.abs(np.vdot(v1, v2))
        overlap = np.clip(overlap, 0.0, 1.0)
        return np.arccos(overlap)

    def exp_distance(self, other, alpha=1.0):
        """
        –ü–æ–ª–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —ç–∫—Å–ø–µ—Ä–∏–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º –¥–≤—É—Ö –ì–æ–ª–æ–Ω–æ–º–æ–≤.

        –£—á–∏—Ç—ã–≤–∞–µ—Ç –∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å, –∏ –∫–∞—á–µ—Å—Ç–≤–æ.

        Args:
            other: –¥—Ä—É–≥–æ–π –ì–æ–ª–æ–Ω–æ–º
            alpha: –≤–µ—Å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

        Returns:
            –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ —ç–∫—Å–ø–µ—Ä–∏–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
        """
        e1 = self.get_full_exp()
        e2 = other.get_full_exp()

        intensity_dist = 0.0
        quality_dist = 0.0

        for i in range(min(len(e1), len(e2))):
            intensity_dist += (e1[i]['intensity'] - e2[i]['intensity'])**2
            quality_dist += self.fubini_study_distance(
                e1[i]['quality'], e2[i]['quality']
            )**2

        return np.sqrt(intensity_dist + alpha * quality_dist)

    def interact(self, other, coupling_strength=0.1):
        """
        –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥—Ä—É–≥–∏–º –ì–æ–ª–æ–Ω–æ–º–æ–º.

        –ü—Ä–æ—Å—Ç–µ–π—à–∞—è –º–æ–¥–µ–ª—å: —á–∞—Å—Ç–∏—á–Ω–æ–µ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π.

        Args:
            other: –¥—Ä—É–≥–æ–π –ì–æ–ª–æ–Ω–æ–º
            coupling_strength: —Å–∏–ª–∞ —Å–≤—è–∑–∏ ‚àà [0, 1]
        """
        # –û–±–º–µ–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π (–∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏–∏)
        new_self = (1 - coupling_strength) * self.Gamma + \
                   coupling_strength * other.Gamma
        new_other = (1 - coupling_strength) * other.Gamma + \
                    coupling_strength * self.Gamma

        self.Gamma = new_self
        other.Gamma = new_other

        # –ü–µ—Ä–µ–Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∞
        self.Gamma /= np.trace(self.Gamma)
        other.Gamma /= np.trace(other.Gamma)

    def is_viable(self):
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏: P > P_crit.

        –°–∏—Å—Ç–µ–º–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞, –µ—Å–ª–∏ –µ—ë —á–∏—Å—Ç–æ—Ç–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç
        –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥ P_crit = 2/7 ‚âà 0.286.

        Returns:
            True –µ—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞
        """
        return self.compute_purity() > self.P_CRIT

    def bootstrap(self, max_steps=1000, target_P=None):
        """
        Bootstrap-–∞–ª–≥–æ—Ä–∏—Ç–º: –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç P ‚âà 1/7 –∫ P > P_crit.

        –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É "–º–µ—Ä—Ç–≤–æ—Ä–æ–∂–¥–µ–Ω–∏—è" ‚Äî –∫–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–æ–∂–¥–∞–µ—Ç—Å—è
        –≤ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–º–µ—à–∞–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å P ‚âà 1/7 < P_crit.

        –ê–ª–≥–æ—Ä–∏—Ç–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Å–∏–ª–µ–Ω–Ω—É—é —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

        Args:
            max_steps: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ —à–∞–≥–æ–≤ —ç–≤–æ–ª—é—Ü–∏–∏
            target_P: –¶–µ–ª–µ–≤–∞—è —á–∏—Å—Ç–æ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é P_crit + margin)

        Returns:
            success: True –µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç P > P_crit
        """
        if target_P is None:
            target_P = self.P_CRIT + 0.05  # –ù–µ–±–æ–ª—å—à–æ–π –∑–∞–ø–∞—Å

        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –≤—ã—Å–æ–∫–æ–π —á–∏—Å—Ç–æ—Ç–æ–π
        psi_target = np.ones(7, dtype=complex) / np.sqrt(7)
        self.Gamma_target = np.outer(psi_target, psi_target.conj())

        for step in range(max_steps):
            P = self.compute_purity()

            if P >= target_P:
                return True  # Bootstrap —É—Å–ø–µ—à–µ–Ω

            # –ì—Ä–∞–¥–∏–µ–Ω—Ç —Å–≤–æ–±–æ–¥–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª–µ–Ω –≤–æ –≤—Ä–µ–º—è bootstrap
            delta_F = 1.0  # –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —ç–Ω–µ—Ä–≥–∏–∏

            # –≠–≤–æ–ª—é—Ü–∏—è —Å —É—Å–∏–ª–µ–Ω–Ω–æ–π —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
            self.evolve(dtau=0.01, delta_F=delta_F)

        return self.compute_purity() >= target_P
```

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
# –°–æ–∑–¥–∞–Ω–∏–µ –ì–æ–ª–æ–Ω–æ–º–∞ –≤ —á–∏—Å—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
holon = Holon(pure=True)
print(f"–ù–∞—á–∞–ª—å–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞: P = {holon.compute_purity():.4f}")  # P = 1.0
print(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞: P_crit = {Holon.P_CRIT:.4f}")  # ‚âà 0.2857

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–ª–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
holon.set_target_state()  # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ –∫–∞–∫ —Ü–µ–ª—å

# –≠–≤–æ–ª—é—Ü–∏—è —Å –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏–µ–π –∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
for t in range(1000):
    # delta_F > 0 –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é
    holon.evolve(dtau=0.01, delta_F=0.5)

    if t % 100 == 0:
        P = holon.compute_purity()
        S = holon.compute_entropy()
        kappa_0 = holon.compute_kappa_0()
        print(f"t={t}: P={P:.4f}, S={S:.4f}, Œ∫‚ÇÄ={kappa_0:.4f}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
print(f"\n–ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞: {holon.is_viable()}")  # P > P_crit?

# –ê–Ω–∞–ª–∏–∑ –ø–æ–ª–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è
full_exp = holon.get_full_exp()
print("\n–≠–∫—Å–ø–µ—Ä–∏–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:")
for i, e in enumerate(full_exp[:3]):  # –¢–æ–ø-3
    print(f"  Exp {i}: intensity={e['intensity']:.4f}")
    print(f"          quality={e['quality'][:3]}...")

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö –ì–æ–ª–æ–Ω–æ–º–æ–≤
holon2 = Holon(pure=True)
holon2.evolve(dtau=0.5)

d_intensity = np.linalg.norm(
    np.array(holon.get_exp()) - np.array(holon2.get_exp())
)
d_full = holon.exp_distance(holon2, alpha=1.0)

print(f"\n–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø–æ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏: {d_intensity:.4f}")
print(f"–ü–æ–ª–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (—Å –∫–∞—á–µ—Å—Ç–≤–æ–º): {d_full:.4f}")
```

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏–∑–æ—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç–∏

```python
# –î–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Å–ø–µ–∫—Ç—Ä–æ–º, –Ω–æ —Ä–∞–∑–Ω—ã–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞–º–∏
print("\n‚Äî –ò–∑–æ—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä ‚Äî")

holon = Holon(pure=True)
holon.evolve(dtau=0.1)
e1 = holon.get_full_exp()

# –°–æ–∑–¥–∞—ë–º –∏–∑–æ—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ —É–Ω–∏—Ç–∞—Ä–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
U_random = np.linalg.qr(
    np.random.randn(7, 7) + 1j*np.random.randn(7, 7)
)[0]
holon_iso = Holon(pure=True)
holon_iso.Gamma = U_random @ holon.Gamma @ U_random.conj().T

# –ü—Ä–æ–≤–µ—Ä–∫–∞
spectra_equal = np.allclose(holon.get_exp(), holon_iso.get_exp())
quality_distance = Holon.fubini_study_distance(
    e1[0]['quality'],
    holon_iso.get_full_exp()[0]['quality']
)

print(f"–°–ø–µ–∫—Ç—Ä—ã —Ä–∞–≤–Ω—ã: {spectra_equal}")
print(f"–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤: d_FS = {quality_distance:.4f}")
```

## –ü—Ä–∏–º–µ—Ä Bootstrap

```python
# –°–æ–∑–¥–∞–Ω–∏–µ "–º—ë—Ä—Ç–≤–æ–π" —Å–∏—Å—Ç–µ–º—ã (P –±–ª–∏–∑–∫–æ –∫ 1/7)
holon = Holon(pure=False)
holon.Gamma = np.eye(7, dtype=complex) / 7  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–º–µ—à–∞–Ω–Ω–æ–µ

print(f"–ù–∞—á–∞–ª—å–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞: P = {holon.compute_purity():.4f}")  # ‚âà 0.143
print(f"P_crit = {Holon.P_CRIT:.4f}")  # = 2/7 ‚âà 0.2857
print(f"–ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞: {holon.is_viable()}")  # False

# Bootstrap: –ø–µ—Ä–µ—Ö–æ–¥ P: 1/7 ‚Üí P_crit
success = holon.bootstrap(max_steps=500)

print(f"\nBootstrap —É—Å–ø–µ—à–µ–Ω: {success}")
print(f"–ö–æ–Ω–µ—á–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞: P = {holon.compute_purity():.4f}")
print(f"–ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞: {holon.is_viable()}")
print(f"Œ∫‚ÇÄ = {holon.compute_kappa_0():.4f}")
```

## –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: –ú–µ—Ä—ã —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

:::danger –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
–ö–ª–∞—Å—Å `HolonExtended` —Å–æ–¥–µ—Ä–∂–∏—Ç **–∑–∞–≥–ª—É—à–∫–∏ (stubs)** –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:

| –ú–µ—Ç–æ–¥ | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–±–ª–µ–º–∞ |
|---|---|---|
| `compute_reflection()` | [–°] **–ó–ê–ì–õ–£–®–ö–ê** | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `min(1, purity)` –≤–º–µ—Å—Ç–æ $1 - \|\Gamma - \varphi(\Gamma)\|^2 / \|\Gamma\|^2$ |
| `compute_reflection_n()` | [–°] **–ó–ê–ì–õ–£–®–ö–ê** | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç $R^n$ –≤–º–µ—Å—Ç–æ fidelity $F(\varphi^{(n-1)}, \varphi^{(n)})$ |
| `D_diff` | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | –¢—Ä–µ–±—É–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–ª–µ–¥–∞ (—Ç–µ–Ω–∑–æ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞–ª–∏–∑–º) |

**–°–ª–µ–¥—Å—Ç–≤–∏–µ:** –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Ä–æ–≤–Ω–µ–π L2/L3/L4 **–Ω–µ–Ω–∞–¥—ë–∂–Ω–∞**. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ L0/L1 –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á.

–î–ª—è –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä $\varphi$ ‚Äî —Å–º. [–§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è œÜ](/docs/proofs/categorical/formalization-phi).
:::

:::info –£—Ä–æ–≤–Ω–∏ –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏
–£—Ä–æ–≤–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç n-—É—Å–µ—á–µ–Ω–∏—è–º ‚àû-–≥—Ä—É–ø–ø–æ–∏–¥–∞ $\mathbf{Exp}_\infty$:
- L0: $\tau_{\leq 0}$ ‚Äî —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç—ã (–∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç—å)
- L1: $\tau_{\leq 1}$ ‚Äî 1-–º–æ—Ä—Ñ–∏–∑–º—ã (—Ñ–µ–Ω–æ–º–µ–Ω–∞–ª—å–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è)
- L2: $\tau_{\leq 2}$ ‚Äî 2-–º–æ—Ä—Ñ–∏–∑–º—ã (–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ –∫–≤–∞–ª–∏–∞)
- L3: $\tau_{\leq 3}$ ‚Äî 3-–º–æ—Ä—Ñ–∏–∑–º—ã (—Å–µ—Ç–µ–≤–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ, –º–µ—Ç–∞—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ)
- L4: –ø–æ–ª–Ω—ã–π ‚àû-–≥—Ä—É–ø–ø–æ–∏–¥ (—É–Ω–∏—Ç–∞—Ä–Ω–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ)
:::

```python
class HolonExtended(Holon):
    """
    –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –º–µ—Ä–∞–º–∏ —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

    –î–æ–±–∞–≤–ª—è–µ—Ç –∫ –±–∞–∑–æ–≤–æ–º—É –∫–ª–∞—Å—Å—É Holon:
    - –ú–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Œ¶, —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ R, —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ –≤—ã—Å—à–∏—Ö –ø–æ—Ä—è–¥–∫–æ–≤ R^(n)
    - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é —É—Ä–æ–≤–Ω–µ–π –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏ L0/L1/L2/L3/L4
    - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–µ—Ä—ã —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ C = Œ¶ ¬∑ D ¬∑ R

    –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (—ç–≤–æ–ª—é—Ü–∏—è dŒì/dœÑ = -i[H,Œì] + D[Œì] + R[Œì,E],
    bootstrap, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏) –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç Holon.

    –£—Ä–æ–≤–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç n-—É—Å–µ—á–µ–Ω–∏—è–º ‚àû-–≥—Ä—É–ø–ø–æ–∏–¥–∞:
    - L0: œÑ_‚â§0 (–∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç—å)
    - L1: œÑ_‚â§1 (—Ñ–µ–Ω–æ–º–µ–Ω–∞–ª—å–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è), Œ¶ > 0
    - L2: œÑ_‚â§2 (–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ –∫–≤–∞–ª–∏–∞), R_th = 1/3, Œ¶_th = 1
    - L3: œÑ_‚â§3 (—Å–µ—Ç–µ–≤–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ), R^(2)_th = 1/4, –º–µ—Ç–∞—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ
    - L4: –ø–æ–ª–Ω—ã–π ‚àû-–≥—Ä—É–ø–ø–æ–∏–¥ (—É–Ω–∏—Ç–∞—Ä–Ω–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ), P > 6/7
    """

    # –ü–æ—Ä–æ–≥–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É—Ä–æ–≤–Ω–µ–π
    # R-–ø–æ—Ä–æ–≥–∏: —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ R^(n)_th = 1/(n+1) –∏–∑ –±–∞–π–µ—Å–æ–≤—Å–∫–æ–≥–æ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    # Œ¶_th = 1: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—é (–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–∞—è –¥–æ–º–∏–Ω–∞—Ü–∏—è)
    PHI_TH = 1.0  # –ü–æ—Ä–æ–≥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–ª—è L2 (–∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ ‚â• –¥–∏–∞–≥–æ–Ω–∞–ª–∏)
    R_TH = 1/3    # –ü–æ—Ä–æ–≥ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ –¥–ª—è L2
    R2_TH = 1/4   # –ü–æ—Ä–æ–≥ R^(2) –¥–ª—è L3
    P_L4 = 6/7    # –ü–æ—Ä–æ–≥ —á–∏—Å—Ç–æ—Ç—ã –¥–ª—è L4

    def compute_integration(self):
        """
        –ú–µ—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Œ¶ = Œ£|Œ≥_ij|¬≤ / Œ£Œ≥_ii¬≤.

        –ò–∑–º–µ—Ä—è–µ—Ç —Å—Ç–µ–ø–µ–Ω—å —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏.
        –í—ã—Å–æ–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è –Ω–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã.

        Returns:
            Œ¶ ‚àà [0, +‚àû) ‚Äî –º–µ—Ä–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π
        """
        diag_sum = np.sum(np.diag(self.Gamma)**2)
        off_diag_sum = np.sum(np.abs(self.Gamma)**2) - diag_sum

        if diag_sum < 1e-12:
            return 0.0
        return off_diag_sum / diag_sum

    def compute_reflection(self):
        """
        –ú–µ—Ä–∞ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ R = 1 - ||Œì - œÜ(Œì)||¬≤ / ||Œì||¬≤.

        –ü—Ä–∏–±–ª–∏–∂—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ œÜ.
        –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ
        –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –õ–∏—É–≤–∏–ª–ª–∏–∞–Ω–∞ L_Œ© ‚Äî —Å–º. /docs/proofs/categorical/formalization-phi.

        **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è:**
        œÜ –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç Œì –Ω–∞ "—Å—Ç–∞–±–∏–ª—å–Ω—É—é" –ø–æ–¥—Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –≤ –ø–µ—Ä–≤–æ–º
        –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è).
        –î–ª—è E-anchored —Å–∏—Å—Ç–µ–º: œÜ(Œì) ‚âà diag(Œì).

        –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:
        R ‚âà ||diag(Œì)||¬≤_F / ||Œì||¬≤_F = Œ£|Œ≥_ii|¬≤ / Œ£|Œ≥_ij|¬≤

        –≠—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ "–Ω–∞—Å–µ–ª—ë–Ω–Ω–æ—Å—Ç–µ–π" (–¥–∏–∞–≥–æ–Ω–∞–ª—å) –∫ –ø–æ–ª–Ω–æ–π –Ω–æ—Ä–º–µ.
        –ü—Ä–∏ R ‚Üí 1 —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ (–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–µ).
        –ü—Ä–∏ R < 1 –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏.

        Returns:
            R ‚àà [0, 1] ‚Äî –º–µ—Ä–∞ —Å–∞–º–æ—Ä–µ—Ñ–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (–ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ)
        """
        # –ù–æ—Ä–º–∞ –§—Ä–æ–±–µ–Ω–∏—É—Å–∞ –ø–æ–ª–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
        total_norm_sq = np.sum(np.abs(self.Gamma)**2)
        if total_norm_sq < 1e-12:
            return 0.0

        # –ù–æ—Ä–º–∞ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞)
        diag_norm_sq = np.sum(np.abs(np.diag(self.Gamma))**2)

        # R = ||diag(Œì)||¬≤ / ||Œì||¬≤
        return float(diag_norm_sq / total_norm_sq)

    def compute_reflection_n(self, n: int = 1):
        """
        –†–µ—Ñ–ª–µ–∫—Å–∏—è n-–≥–æ –ø–æ—Ä—è–¥–∫–∞ R^(n).

        R^(n)(Œì) := Fid(œÜ^(n-1)(Œì), œÜ^(n)(Œì))

        –≥–¥–µ Fid ‚Äî fidelity, œÜ^(k) ‚Äî k-–∫—Ä–∞—Ç–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ œÜ.

        **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è:**
        œÜ –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç Œì –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω—É—é —á–∞—Å—Ç—å (‚âà –¥–∏–∞–≥–æ–Ω–∞–ª—å).
        –ü—Ä–∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏: œÜ^(n)(Œì) ‚Üí diag(Œì) —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ.
        –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ: R^(n) ‚Üí 1 –ø—Ä–∏ n ‚Üí ‚àû –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

        –ú–æ–¥–µ–ª—å: R^(n) ‚âà 1 - (1-R)¬∑exp(-n/œÑ_conv), –≥–¥–µ œÑ_conv = 1.
        –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç: R^(n) = R + (1-R)¬∑(1 - e^{-n}).

        –î–ª—è n=1: R^(1) = R
        –î–ª—è n‚Üí‚àû: R^(n) ‚Üí 1 (—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ—á–∫–µ)

        –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî —Å–º. /docs/proofs/categorical/formalization-phi#—Ä–µ—Ñ–ª–µ–∫—Å–∏—è-n-–≥–æ-–ø–æ—Ä—è–¥–∫–∞.

        Args:
            n: –ü–æ—Ä—è–¥–æ–∫ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ (1, 2, 3, ...)

        Returns:
            R^(n) ‚àà [0, 1]
        """
        if n < 1:
            return 1.0

        R = self.compute_reflection()
        # –ú–æ–¥–µ–ª—å: —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –∫ 1
        # R^(n) = R + (1-R)¬∑(1 - exp(-n))
        # –ü—Ä–∏ n=1: R^(1) ‚âà R + 0.632¬∑(1-R)
        # –ü—Ä–∏ n‚Üí‚àû: R^(n) ‚Üí 1
        convergence_factor = 1.0 - np.exp(-n)
        return R + (1.0 - R) * convergence_factor

    def classify_level(self):
        """
        –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏: L0, L1, L2, L3, L4.

        –£—Ä–æ–≤–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç n-—É—Å–µ—á–µ–Ω–∏—è–º ‚àû-–≥—Ä—É–ø–ø–æ–∏–¥–∞ Exp_‚àû:
            - non-viable: P ‚â§ P_crit (—Å–∏—Å—Ç–µ–º–∞ –Ω–µ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞)
            - L0: P > P_crit, œÑ_‚â§0 (–±–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç—å)
            - L1: L0 + Œ¶ ‚â• Œ¶_th, œÑ_‚â§1 (—Ñ–µ–Ω–æ–º–µ–Ω–∞–ª—å–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è)
            - L2: L1 + R ‚â• R_th, œÑ_‚â§2 (–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ –∫–≤–∞–ª–∏–∞)
            - L3: L2 + R^(2) ‚â• R2_th, œÑ_‚â§3 (—Å–µ—Ç–µ–≤–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ, –ú–ï–¢–ê–°–¢–ê–ë–ò–õ–¨–ù–û–ï)
            - L4: L3 + P > 6/7, –ø–æ–ª–Ω—ã–π ‚àû-–≥—Ä—É–ø–ø–æ–∏–¥ (—É–Ω–∏—Ç–∞—Ä–Ω–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ)

        –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –ø–æ—Ä–æ–≥–æ–≤: X^(n)_th = 1/(n+1)

        Returns:
            –°—Ç—Ä–æ–∫–∞: "L0", "L1", "L2", "L3", "L4", –∏–ª–∏ "non-viable"
        """
        P = self.compute_purity()

        if P <= self.P_CRIT:
            return "non-viable"

        Phi = self.compute_integration()
        R = self.compute_reflection()
        R2 = self.compute_reflection_n(2)

        # L4: –£–Ω–∏—Ç–∞—Ä–Ω–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å)
        if P > self.P_L4 and R2 >= self.R2_TH:
            return "L4"

        # L3: –°–µ—Ç–µ–≤–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ (–º–µ—Ç–∞—Å—Ç–∞–±–∏–ª—å–Ω–æ–µ!)
        if R >= self.R_TH and Phi >= self.PHI_TH and R2 >= self.R2_TH:
            return "L3"

        # L2: –ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ –∫–≤–∞–ª–∏–∞ (R ‚â• 1/3, Œ¶ ‚â• 1)
        if R >= self.R_TH and Phi >= self.PHI_TH:
            return "L2"

        # L1: –§–µ–Ω–æ–º–µ–Ω–∞–ª—å–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è (Œ¶ > 0, —Ç.–µ. –ª—é–±–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
        if Phi > 0:
            return "L1"

        # L0: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç—å (Œì ‚â† I/7)
        return "L0"

    def compute_l3_lifetime(self):
        """
        –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ L3 (—Å–µ—Ç–µ–≤–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ).

        œÑ_3 = 1 / (Œ∫_bootstrap ¬∑ (1 - R^(2)))

        L3 –º–µ—Ç–∞—Å—Ç–∞–±–∏–ª—å–Ω–æ: –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Ä–∞—Å–ø–∞–¥–∞–µ—Ç—Å—è –∑–∞ –≤—Ä–µ–º—è œÑ_3.

        Returns:
            œÑ_3 ‚Äî —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞—Å–ø–∞–¥–∞ L3
        """
        R2 = self.compute_reflection_n(2)
        if R2 >= 1.0:
            return float('inf')  # –°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        return 1.0 / (self.KAPPA_BOOTSTRAP * (1 - R2))
```

### –ü—Ä–∏–º–µ—Ä –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

```python
# –°–æ–∑–¥–∞–Ω–∏–µ –∏ —ç–≤–æ–ª—é—Ü–∏—è –ì–æ–ª–æ–Ω–æ–º–∞
holon = HolonExtended(pure=True)
holon.set_target_state()

print(f"–ù–∞—á–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å: {holon.classify_level()}")

# –≠–≤–æ–ª—é—Ü–∏—è —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏
for t in range(500):
    holon.evolve(dtau=0.01, delta_F=0.3)

    if t % 100 == 0:
        level = holon.classify_level()
        P = holon.compute_purity()
        Phi = holon.compute_integration()
        R = holon.compute_reflection()
        R2 = holon.compute_reflection_n(2)
        print(f"t={t}: P={P:.4f}, Œ¶={Phi:.4f}, R={R:.4f}, R¬≤={R2:.4f}, —É—Ä–æ–≤–µ–Ω—å={level}")

        # –î–ª—è L3: –ø–æ–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏
        if level == "L3":
            tau3 = holon.compute_l3_lifetime()
            print(f"       œÑ_3 (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ L3) = {tau3:.2f}")
```

:::danger –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî L2/L3/L4 –Ω–µ–Ω–∞–¥—ë–∂–Ω—ã
**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≥–ª—É—à–∫–∏:**
1. **–ú–µ—Ä–∞ R ‚Äî –ó–ê–ì–õ–£–®–ö–ê:** `compute_reflection()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–π –Ω–æ—Ä–º—ã –∫ –ø–æ–ª–Ω–æ–π –Ω–æ—Ä–º–µ –§—Ä–æ–±–µ–Ω–∏—É—Å–∞, –Ω–µ –∏—Å—Ç–∏–Ω–Ω—É—é —Ä–µ—Ñ–ª–µ–∫—Å–∏—é
2. **R^(n) ‚Äî –ó–ê–ì–õ–£–®–ö–ê:** `compute_reflection_n()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç $R^n$, –Ω–µ fidelity $F(\varphi^{(n-1)}, \varphi^{(n)})$
3. **D_diff ‚Äî –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –¢—Ä–µ–±—É–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–ª–µ–¥–∞ (—Ç–µ–Ω–∑–æ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞–ª–∏–∑–º)

**–°–ª–µ–¥—Å—Ç–≤–∏–µ:** –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è `classify_level()` **–Ω–∞–¥—ë–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è L0 –∏ L1**. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã L2/L3/L4 ‚Äî –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–µ.

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
4. **Œì_target = const:** –í –ø–æ–ª–Ω–æ–π —Ç–µ–æ—Ä–∏–∏ $\rho_* = \varphi(\Gamma)$ ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $\mathcal{L}_\Omega$ [–¢], –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Œì
5. **L3 –º–µ—Ç–∞—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏ —Ä–∞—Å–ø–∞–¥–∞

–î–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã —Å–º. [–§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è œÜ](/docs/proofs/categorical/formalization-phi) –∏ [–ò–µ—Ä–∞—Ä—Ö–∏—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏](/docs/proofs/consciousness/interiority-hierarchy).
:::

## –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏–∑ L-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏

:::info –°—Ç–∞—Ç—É—Å: –ö–∞—Ç–µ–≥–æ—Ä–Ω–æ –≤—ã–≤–µ–¥–µ–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
–°–ª–µ–¥—É—é—â–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, **–≤—ã–≤–µ–¥–µ–Ω–Ω—ã–µ** –∏–∑ [–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø–æ–¥–æ–±—ä–µ–∫—Ç–æ–≤ Œ©](/docs/core/foundations/axiom-omega#–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è-–ª–æ–≥–∏–∫–∞). –≠—Ç–æ –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî –æ–Ω–∏ —Å–ª–µ–¥—É—é—Ç –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–µ–æ—Ä–∏–∏.
:::

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–æ—Ä—Ñ–∏–∑–º œá_S

```python
def characteristic_morphism(Gamma: np.ndarray, S: np.ndarray) -> np.ndarray:
    """
    –í—ã—á–∏—Å–ª–µ–Ω–∏–µ œá_S: Œì ‚Üí Œ© –¥–ª—è –ø–æ–¥–æ–±—ä–µ–∫—Ç–∞ S ‚Ü™ Œì.

    –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–æ—Ä—Ñ–∏–∑–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç "—Å—Ç–µ–ø–µ–Ω—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏"
    —Å–æ—Å—Ç–æ—è–Ω–∏—è Œì –∫ –ª–æ–≥–∏—á–µ—Å–∫–∏ –¥–æ–ø—É—Å—Ç–∏–º–æ–º—É –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É S.

    –ö–∞—Ç–µ–≥–æ—Ä–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:
        œá_S = S @ Gamma @ S ‚Äî —Å—É–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ–¥–æ–±—ä–µ–∫—Ç

    Args:
        Gamma: –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ [7, 7], —ç—Ä–º–∏—Ç–æ–≤–∞, PSD, Tr=1
        S: –ü—Ä–æ–µ–∫—Ç–æ—Ä –ø–æ–¥–æ–±—ä–µ–∫—Ç–∞ [7, 7], S¬≤ = S, S‚Ä† = S

    Returns:
        chi_S: –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ç—Ä–∏—Ü–∞ [7, 7]

    Raises:
        AssertionError: –µ—Å–ª–∏ S –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–µ–∫—Ç–æ—Ä–æ–º
    """
    # –ü—Ä–æ–≤–µ—Ä–∫–∞: S ‚Äî –ø—Ä–æ–µ–∫—Ç–æ—Ä
    assert np.allclose(S @ S, S, atol=1e-10), "S must be idempotent (S¬≤ = S)"
    assert np.allclose(S, S.conj().T, atol=1e-10), "S must be Hermitian (S‚Ä† = S)"

    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ—Ä—Ñ–∏–∑–º–∞
    chi_S = S @ Gamma @ S

    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ —Å–ª–µ–¥ –Ω–µ–Ω—É–ª–µ–≤–æ–π)
    trace = np.trace(chi_S)
    if np.abs(trace) > 1e-12:
        chi_S = chi_S / trace

    return chi_S
```

### –¢–µ–º–ø–æ—Ä–∞–ª—å–Ω–∞—è –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å ‚ñ∑

```python
def temporal_modality(omega_state: np.ndarray) -> np.ndarray:
    """
    –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º–ø–æ—Ä–∞–ª—å–Ω–æ–π –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏ ‚ñ∑: Œ© ‚Üí Œ©.

    ‚ñ∑ ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä "–ø–æ–∑–∂–µ", –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–π –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –≤—Ä–µ–º—è œÑ ‚àà ‚Ñ§‚Çá.

    –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:
        œÑ_n = ‚ñ∑^n(now), –≥–¥–µ now = œÑ_0

    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
        ‚ñ∑ = —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –≤ –±–∞–∑–∏—Å–µ —á–∞—Å–æ–≤ |k‚ü© ‚Üí |k+1 mod 7‚ü©

    Args:
        omega_state: –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–µ Œ© [7, 7]

    Returns:
        –°–¥–≤–∏–Ω—É—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚ñ∑(omega_state)
    """
    # –ú–∞—Ç—Ä–∏—Ü–∞ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ —Å–¥–≤–∏–≥–∞
    V_shift = np.roll(np.eye(7), 1, axis=0)

    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ: ‚ñ∑(œÅ) = V ¬∑ œÅ ¬∑ V‚Ä†
    return V_shift @ omega_state @ V_shift.conj().T


def time_sequence(initial_state: np.ndarray, n_steps: int = 7) -> list:
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ œÑ_0, œÑ_1, ..., œÑ_{n-1}.

    Args:
        initial_state: –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (now = œÑ_0)
        n_steps: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7 = –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª)

    Returns:
        –°–ø–∏—Å–æ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–π [œÑ_0, œÑ_1, ..., œÑ_{n-1}]
    """
    states = [initial_state]
    current = initial_state

    for _ in range(n_steps - 1):
        current = temporal_modality(current)
        states.append(current)

    return states
```

### –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞ L_k –∏–∑ Œ©

```python
def compute_lindblad_from_omega(Gamma: np.ndarray) -> list:
    """
    –í—ã–≤–æ–¥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –õ–∏–Ω–¥–±–ª–∞–¥–∞ L_k –∏–∑ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø–æ–¥–æ–±—ä–µ–∫—Ç–æ–≤ Œ©.

    –ö–∞—Ç–µ–≥–æ—Ä–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (L-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è):
        L_k = ‚àöœá_{S_k}

    –≥–¥–µ S_k ‚Äî k-–π –∞—Ç–æ–º (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ–¥–æ–±—ä–µ–∫—Ç) –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ Œ©.

    –î–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ 7D-—Ñ–æ—Ä–º–∞–ª–∏–∑–º–∞ –∞—Ç–æ–º—ã = –ø—Ä–æ–µ–∫—Ç–æ—Ä—ã –Ω–∞ –±–∞–∑–∏—Å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
        S_k = |k‚ü©‚ü®k|, k ‚àà {A, S, D, L, E, O, U}

    Args:
        Gamma: –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ [7, 7]

    Returns:
        L_operators: –°–ø–∏—Å–æ–∫ –∏–∑ 7 –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –õ–∏–Ω–¥–±–ª–∞–¥–∞

    –°–≤–æ–π—Å—Ç–≤–æ (CPTP-—É—Å–ª–æ–≤–∏–µ):
        Œ£_k L_k‚Ä† L_k = ùüô ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –±–∞–∑–∏—Å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ—Ä–æ–≤ S_k = |k‚ü©‚ü®k|.

    –í–ê–ñ–ù–û: CPTP-–∫–∞–Ω–∞–ª—ã –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —á–∏—Å—Ç–æ—Ç—É –∏ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.
    CPTP-–∫–∞–Ω–∞–ª –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (P > P_crit) –≤ –Ω–µ–∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ–µ.
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏—è –ø–æ–ª–Ω–æ—Ç—ã (Œ£ L_k‚Ä† L_k = ùüô) –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ª–∏—à—å
    —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–ª–µ–¥–∞ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ –Ω–µ P > P_crit.
    """
    L_operators = []

    # –ê—Ç–æ–º—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ = –±–∞–∑–∏—Å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–æ—Ä—ã
    for k in range(7):
        # –ü—Ä–æ–µ–∫—Ç–æ—Ä –Ω–∞ k-–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ
        S_k = np.zeros((7, 7), dtype=complex)
        S_k[k, k] = 1.0

        # –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–æ—Ä—Ñ–∏–∑–º
        chi_k = characteristic_morphism(Gamma, S_k)

        # –ú–∞—Ç—Ä–∏—á–Ω—ã–π –∫–æ—Ä–µ–Ω—å (–¥–ª—è —ç—Ä–º–∏—Ç–æ–≤–æ–π PSD –º–∞—Ç—Ä–∏—Ü—ã)
        eigvals, eigvecs = np.linalg.eigh(chi_k)
        sqrt_eigvals = np.sqrt(np.maximum(eigvals, 0))
        L_k = eigvecs @ np.diag(sqrt_eigvals) @ eigvecs.conj().T

        L_operators.append(L_k)

    return L_operators


def verify_cptp_condition(L_operators: list) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä–∫–∞ CPTP-—É—Å–ª–æ–≤–∏—è: Œ£_k L_k‚Ä† L_k = ùüô.

    Returns:
        True –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é 1e-10
    """
    total = sum(L.conj().T @ L for L in L_operators)
    return np.allclose(total, np.eye(7), atol=1e-10)
```

### –õ–æ–≥–∏—á–µ—Å–∫–∏–π –õ–∏—É–≤–∏–ª–ª–∏–∞–Ω ‚Ñí_Œ©

```python
def logical_liouvillian(Gamma: np.ndarray, H: np.ndarray,
                         gamma_rates: np.ndarray = None) -> np.ndarray:
    """
    –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –õ–∏—É–≤–∏–ª–ª–∏–∞–Ω–∞ ‚Ñí_Œ©[Œì].

    ‚Ñí_Œ©[Œì] = -i[H, Œì] + Œ£_k Œ≥_k (L_k Œì L_k‚Ä† - ¬Ω{L_k‚Ä†L_k, Œì})

    –≥–¥–µ L_k = ‚àöœá_{S_k} ‚Äî –≤—ã–≤–µ–¥–µ–Ω—ã –∏–∑ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ Œ©.

    Args:
        Gamma: –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ [7, 7]
        H: –ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω [7, 7]
        gamma_rates: –°–∫–æ—Ä–æ—Å—Ç–∏ –¥–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏–∏ [7] (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–Ω—ã–µ)

    Returns:
        ‚Ñí_Œ©[Œì]: –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –º–∞—Ç—Ä–∏—Ü—ã –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏
    """
    if gamma_rates is None:
        gamma_rates = np.ones(7) * 0.01  # –¢–∏–ø–∏—á–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å

    # 1. –£–Ω–∏—Ç–∞—Ä–Ω–∞—è —á–∞—Å—Ç—å: -i[H, Œì]
    unitary = -1j * (H @ Gamma - Gamma @ H)

    # 2. –î–∏—Å—Å–∏–ø–∞—Ç–∏–≤–Ω–∞—è —á–∞—Å—Ç—å: D_Œ©[Œì]
    L_operators = compute_lindblad_from_omega(Gamma)
    dissipator = np.zeros_like(Gamma)

    for k, L_k in enumerate(L_operators):
        L_dag = L_k.conj().T
        dissipator += gamma_rates[k] * (
            L_k @ Gamma @ L_dag
            - 0.5 * (L_dag @ L_k @ Gamma + Gamma @ L_dag @ L_k)
        )

    return unitary + dissipator
```

### –û–ø–µ—Ä–∞—Ç–æ—Ä —Å–∞–º–æ–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è œÜ —á–µ—Ä–µ–∑ ‚Ñí_Œ©

```python
def phi_from_liouvillian(Gamma: np.ndarray, H: np.ndarray,
                          tau_period: int = 7, dtau: float = 0.1) -> np.ndarray:
    """
    –í—ã—á–∏—Å–ª–µ–Ω–∏–µ œÜ(Œì) –∫–∞–∫ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ‚Ñí_Œ©.

    –¢–µ–æ—Ä–µ–º–∞:
        œÜ(Œì) = lim_{œÑ‚Üí‚àû} e^{œÑ¬∑‚Ñí_Œ©}[Œì]

    –î–ª—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ œÑ-–ø–µ—Ä–∏–æ–¥–∞:
        œÜ(Œì) ‚âà —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –æ—Ä–±–∏—Ç–µ –∑–∞ –ø–µ—Ä–∏–æ–¥ œÑ

    Args:
        Gamma: –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ [7, 7]
        H: –ì–∞–º–∏–ª—å—Ç–æ–Ω–∏–∞–Ω [7, 7]
        tau_period: –ü–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7 = –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª ‚Ñ§‚Çá)
        dtau: –®–∞–≥ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –≤—Ä–µ–º—è œÑ)

    Returns:
        œÜ(Œì): –°–∞–º–æ–º–æ–¥–µ–ª—å ‚Äî —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    """
    trajectory = [Gamma]
    current = Gamma.copy()

    n_steps = int(tau_period / dtau)

    for _ in range(n_steps):
        # –≠–≤–æ–ª—é—Ü–∏—è –Ω–∞ –æ–¥–∏–Ω —à–∞–≥: Œì_{œÑ+dœÑ} = Œì_œÑ + dœÑ ¬∑ ‚Ñí_Œ©[Œì_œÑ]
        L_Omega = logical_liouvillian(current, H)
        current = current + dtau * L_Omega

        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
        current = current / np.trace(current)

        trajectory.append(current)

    # œÜ = —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –æ—Ä–±–∏—Ç–µ (—Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
    phi_Gamma = np.mean(trajectory, axis=0)

    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ö–æ–¥–∞
    phi_Gamma = phi_Gamma / np.trace(phi_Gamma)

    return phi_Gamma
```

### –ü—Ä–∏–º–µ—Ä: –ü–æ–ª–Ω–∞—è L-—É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è

```python
# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
Gamma = Holon(pure=True).Gamma
H = Holon()._build_hamiltonian()

# 1. –í—ã–≤–µ—Å—Ç–∏ L_k –∏–∑ Œ©
L_operators = compute_lindblad_from_omega(Gamma)
print(f"CPTP-—É—Å–ª–æ–≤–∏–µ: {verify_cptp_condition(L_operators)}")  # True

# 2. –í—ã—á–∏—Å–ª–∏—Ç—å ‚Ñí_Œ©
L_Omega = logical_liouvillian(Gamma, H)
print(f"||‚Ñí_Œ©[Œì]||_F = {np.linalg.norm(L_Omega):.4f}")

# 3. –ù–∞–π—Ç–∏ œÜ(Œì)
phi_Gamma = phi_from_liouvillian(Gamma, H)
print(f"P(œÜ(Œì)) = {np.real(np.trace(phi_Gamma @ phi_Gamma)):.4f}")

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å
R = 1 - np.linalg.norm(Gamma - phi_Gamma)**2 / np.linalg.norm(Gamma)**2
print(f"R(Œì) = {R:.4f}")  # –ú–µ—Ä–∞ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏
```

## –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –ì—Ä–æ—Ç–µ–Ω–¥–∏–∫–∞ {#–∞–ª–≥–æ—Ä–∏—Ç–º—ã-—Ç–æ–ø–æ–ª–æ–≥–∏–∏}

:::info –°–≤—è–∑—å —Å —Ç–µ–æ—Ä–∏–µ–π
–°–ª–µ–¥—É—é—â–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç [—Ç–æ–ø–æ–ª–æ–≥–∏—é –ì—Ä–æ—Ç–µ–Ω–¥–∏–∫–∞](/docs/core/foundations/axiom-omega#—Ç–æ–ø–æ–ª–æ–≥–∏—è-–≥—Ä–æ—Ç–µ–Ω–¥–∏–∫–∞) –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ $\mathcal{C} = \mathbf{DensityMat}$, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–Ω—è—Ç–∏–µ ¬´–ø—É—á–∫–∞¬ª –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–æ–±—ä–µ–∫—Ç–æ–≤ Œ©.
:::

### –ú–µ—Ç—Ä–∏–∫–∞ –ë—é—Ä–µ—Å–∞

```python
from scipy.linalg import sqrtm

def bures_distance(rho: np.ndarray, sigma: np.ndarray) -> float:
    """
    –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –ë—é—Ä–µ—Å–∞ –º–µ–∂–¥—É –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ (—Ö–æ—Ä–¥–æ–≤–∞—è —Ñ–æ—Ä–º–∞).

    –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (—Ö–æ—Ä–¥–æ–≤–∞—è —Ñ–æ—Ä–º–∞):
        d_B^chord(œÅ, œÉ) = ‚àö(2(1 - ‚àöF(œÅ, œÉ)))

    –≥–¥–µ F(œÅ, œÉ) = (Tr‚àö(‚àöœÅ œÉ ‚àöœÅ))¬≤ ‚Äî fidelity.

    –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —É–≥–ª–æ–≤–∞—è —Ñ–æ—Ä–º–∞ d_B^angle = arccos(‚àöF). –°–º. docs/reference/notation.

    –°–≤–æ–π—Å—Ç–≤–∞:
        - d_B^chord ‚àà [0, ‚àö2]
        - –ú–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç—å: d_B(Œ¶(œÅ), Œ¶(œÉ)) ‚â§ d_B(œÅ, œÉ) –¥–ª—è CPTP Œ¶
        - –†–∏–º–∞–Ω–æ–≤–∞ –º–µ—Ç—Ä–∏–∫–∞ –Ω–∞ –º–Ω–æ–≥–æ–æ–±—Ä–∞–∑–∏–∏ –º–∞—Ç—Ä–∏—Ü –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏

    Args:
        rho: –ü–µ—Ä–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ [N, N]
        sigma: –í—Ç–æ—Ä–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ [N, N]

    Returns:
        –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ë—é—Ä–µ—Å–∞ d_B(œÅ, œÉ) ‚àà [0, ‚àö2]
    """
    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ ‚àöœÅ
    sqrt_rho = sqrtm(rho)

    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ ‚àöœÅ œÉ ‚àöœÅ
    inner = sqrt_rho @ sigma @ sqrt_rho

    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ fidelity F = (Tr‚àöinner)¬≤
    sqrt_inner = sqrtm(inner)
    fidelity = np.real(np.trace(sqrt_inner)) ** 2

    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ fidelity –≤ [0, 1] –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    fidelity = np.clip(fidelity, 0.0, 1.0)

    # –ú–µ—Ç—Ä–∏–∫–∞ –ë—é—Ä–µ—Å–∞
    return np.sqrt(2 * (1 - np.sqrt(fidelity)))


def bures_fidelity(rho: np.ndarray, sigma: np.ndarray) -> float:
    """
    –í—ã—á–∏—Å–ª–µ–Ω–∏–µ fidelity (–≤–µ—Ä–Ω–æ—Å—Ç–∏) –º–µ–∂–¥—É –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏.

    F(œÅ, œÉ) = (Tr‚àö(‚àöœÅ œÉ ‚àöœÅ))¬≤

    Args:
        rho, sigma: –ú–∞—Ç—Ä–∏—Ü—ã –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ [N, N]

    Returns:
        Fidelity F ‚àà [0, 1]
    """
    sqrt_rho = sqrtm(rho)
    inner = sqrt_rho @ sigma @ sqrt_rho
    sqrt_inner = sqrtm(inner)
    fidelity = np.real(np.trace(sqrt_inner)) ** 2
    return np.clip(fidelity, 0.0, 1.0)
```

### Bures-–ø–æ–∫—Ä—ã—Ç–∏—è

```python
def generate_ball_samples(
    Gamma: np.ndarray,
    radius: float,
    n_samples: int = 50
) -> list:
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–æ—á–µ–∫ –≤ Bures-—à–∞—Ä–µ B_B(Œì, r).

    Args:
        Gamma: –¶–µ–Ω—Ç—Ä —à–∞—Ä–∞ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ [N, N]
        radius: –†–∞–¥–∏—É—Å —à–∞—Ä–∞ –≤ –º–µ—Ç—Ä–∏–∫–µ –ë—é—Ä–µ—Å–∞
        n_samples: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫

    Returns:
        –°–ø–∏—Å–æ–∫ –º–∞—Ç—Ä–∏—Ü –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –≤ —à–∞—Ä–µ B_B(Œì, r)
    """
    samples = []
    N = Gamma.shape[0]

    for _ in range(n_samples * 10):  # –°—ç–º–ø–ª–∏—Ä—É–µ–º —Å –∑–∞–ø–∞—Å–æ–º
        # –°–ª—É—á–∞–π–Ω–æ–µ —ç—Ä–º–∏—Ç–æ–≤–æ –≤–æ–∑–º—É—â–µ–Ω–∏–µ
        perturbation = np.random.randn(N, N) + 1j * np.random.randn(N, N)
        perturbation = (perturbation + perturbation.conj().T) / 2
        perturbation = perturbation / np.linalg.norm(perturbation) * radius * 0.5

        # –í–æ–∑–º—É—â—ë–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        sigma = Gamma + perturbation

        # –ü—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –º–∞—Ç—Ä–∏—Ü –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
        sigma = (sigma + sigma.conj().T) / 2  # –≠—Ä–º–∏—Ç–æ–≤–æ—Å—Ç—å
        eigenvalues, eigenvectors = np.linalg.eigh(sigma)
        eigenvalues = np.maximum(eigenvalues, 0)  # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
        eigenvalues = eigenvalues / np.sum(eigenvalues)  # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
        sigma = eigenvectors @ np.diag(eigenvalues) @ eigenvectors.conj().T

        # –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –≤ —à–∞—Ä–µ
        if bures_distance(Gamma, sigma) < radius:
            samples.append(sigma)
            if len(samples) >= n_samples:
                break

    return samples


def is_bures_covering(
    Gamma: np.ndarray,
    channels: list,  # List of (Gamma_i, Phi_i) tuples
    epsilon: float = 0.1,
    delta: float = 0.05,
    n_test_points: int = 100
) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä–∫–∞: –æ–±—Ä–∞–∑—É–µ—Ç –ª–∏ —Å–µ–º–µ–π—Å—Ç–≤–æ CPTP-–∫–∞–Ω–∞–ª–æ–≤ Bures-–ø–æ–∫—Ä—ã—Ç–∏–µ.

    –ü–æ–∫—Ä—ã—Ç–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –µ—Å–ª–∏:
        B_B(Œì, Œ¥) ‚äÜ ‚ãÉ·µ¢ Œ¶·µ¢(B_B(Œì·µ¢, Œµ))

    Args:
        Gamma: –¶–µ–ª–µ–≤–æ–π –æ–±—ä–µ–∫—Ç [N, N]
        channels: –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (Gamma_i, Phi_i), –≥–¥–µ Phi_i ‚Äî —Ñ—É–Ω–∫—Ü–∏—è CPTP
        epsilon: –†–∞–¥–∏—É—Å –∏—Å—Ö–æ–¥–Ω—ã—Ö —à–∞—Ä–æ–≤
        delta: –†–∞–¥–∏—É—Å —Ü–µ–ª–µ–≤–æ–≥–æ —à–∞—Ä–∞
        n_test_points: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ç–æ—á–µ–∫

    Returns:
        True –µ—Å–ª–∏ —Å–µ–º–µ–π—Å—Ç–≤–æ –æ–±—Ä–∞–∑—É–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ
    """
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–æ—á–∫–∏ –≤ B_B(Gamma, delta)
    test_points = generate_ball_samples(Gamma, delta, n_test_points)

    for sigma in test_points:
        covered = False
        for Gamma_i, Phi_i in channels:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∫–∞–Ω–∞–ª
            # ‚àÉœÅ ‚àà B_B(Œì·µ¢, Œµ): Œ¶·µ¢(œÅ) ‚âà œÉ
            source_points = generate_ball_samples(Gamma_i, epsilon, 20)
            for source in source_points:
                image = Phi_i(source)
                if bures_distance(image, sigma) < delta / 2:
                    covered = True
                    break
            if covered:
                break

        if not covered:
            return False

    return True
```

### –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä Œ©

```python
class OmegaClassifier:
    """
    –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–æ–±—ä–µ–∫—Ç–æ–≤ Œ© –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ DensityMat.

    –ö–∞—Ç–µ–≥–æ—Ä–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:
        Œ© := ùí™(ùíû, d_B) ‚Äî —Ä–µ—à—ë—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –º–Ω–æ–∂–µ—Å—Ç–≤ –≤ Bures-—Ç–æ–ø–æ–ª–æ–≥–∏–∏

    –î–ª—è –£–ì–ú —Å N = 7 –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏:
        |Œ©| = 7 –∞—Ç–æ–º–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–º–µ—Ä–µ–Ω–∏—è–º A, S, D, L, E, O, U
    """

    DIMENSIONS = ['A', 'S', 'D', 'L', 'E', 'O', 'U']

    def __init__(self, dimension: int = 7):
        self.N = dimension
        self.atoms = self._construct_atoms()

    def _construct_atoms(self) -> dict:
        """
        –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∞—Ç–æ–º–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞.

        –ê—Ç–æ–º S_k = |k‚ü©‚ü®k| ‚Äî –ø—Ä–æ–µ–∫—Ç–æ—Ä –Ω–∞ k-–µ –±–∞–∑–∏—Å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
        """
        atoms = {}
        for k, name in enumerate(self.DIMENSIONS[:self.N]):
            basis = np.zeros(self.N, dtype=complex)
            basis[k] = 1.0
            atoms[name] = np.outer(basis, basis.conj())
        return atoms

    def chi(self, Gamma: np.ndarray, dimension: str) -> float:
        """
        –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–æ—Ä—Ñ–∏–∑–º œá_{S_k}: Œì ‚Üí Œ©.

        –í—ã—á–∏—Å–ª—è–µ—Ç "—Å—Ç–µ–ø–µ–Ω—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏" Œì –∫ k-–º—É –∞—Ç–æ–º—É.

        –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Bures-—Ç–æ–ø–æ–ª–æ–≥–∏—é:
            œá_S(Œì) = sup{r ‚àà [0,1] : B_B(Œì, r) ‚à© S ‚â† ‚àÖ}

        –î–ª—è –ø—Ä–æ–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–¥–æ–±—ä–µ–∫—Ç–∞ S = |k‚ü©‚ü®k|:
            œá_S(Œì) = ‚àöF(Œì, S) = ‚àö‚ü®k|Œì|k‚ü© = ‚àöŒ≥_kk

        Args:
            Gamma: –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ [N, N]
            dimension: –ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è ('A', 'S', 'D', 'L', 'E', 'O', 'U')

        Returns:
            œá_{S_k}(Œì) ‚àà [0, 1]
        """
        S_k = self.atoms[dimension]
        # Fidelity —Å –ø—Ä–æ–µ–∫—Ç–æ—Ä–æ–º = –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
        fidelity = np.real(np.trace(S_k @ Gamma))
        return np.sqrt(np.clip(fidelity, 0.0, 1.0))

    def lindblad_operator(self, dimension: str) -> np.ndarray:
        """
        –û–ø–µ—Ä–∞—Ç–æ—Ä –õ–∏–Ω–¥–±–ª–∞–¥–∞ L_k = ‚àöœá_{S_k}.

        –ö–∞—Ç–µ–≥–æ—Ä–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:
            L_k := ‚àöœá_{S_k} ‚Äî –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–µ –æ—Ç k-–≥–æ –∞—Ç–æ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞

        Args:
            dimension: –ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è

        Returns:
            L_k [N, N] ‚Äî –æ–ø–µ—Ä–∞—Ç–æ—Ä –õ–∏–Ω–¥–±–ª–∞–¥–∞
        """
        S_k = self.atoms[dimension]
        return sqrtm(S_k)

    def all_lindblad_operators(self) -> dict:
        """–í—Å–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –õ–∏–Ω–¥–±–ª–∞–¥–∞ –∏–∑ –∞—Ç–æ–º–æ–≤ Œ©."""
        return {dim: self.lindblad_operator(dim) for dim in self.DIMENSIONS[:self.N]}

    def verify_cptp(self) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ CPTP-—É—Å–ª–æ–≤–∏—è: Œ£‚Çñ L_k‚Ä† L_k = ùïÄ.

        –î–ª—è –±–∞–∑–∏—Å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ—Ä–æ–≤ S_k = |k‚ü©‚ü®k| —É—Å–ª–æ–≤–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑
        —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ (—Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü—ã –Ω–∞ –∞—Ç–æ–º—ã).
        –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–ª–µ–¥–∞ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏,
        –Ω–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–∏—Å—Ç–æ—Ç—ã P –∏–ª–∏ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.
        """
        L_ops = self.all_lindblad_operators()
        sum_LdagL = sum(L.conj().T @ L for L in L_ops.values())
        return np.allclose(sum_LdagL, np.eye(self.N), atol=1e-10)

    def construct_atomic_covering(self, Gamma: np.ndarray) -> list:
        """
        –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∞—Ç–æ–º–∞—Ä–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏.

        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ (S_k, P_k) –≥–¥–µ P_k ‚Äî –ø—Ä–æ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª.

        –¢–µ–æ—Ä–µ–º–∞: –î–ª—è Œì —Å P(Œì) > P_crit = 2/7 —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø–æ–ª–Ω–æ–µ
        –∞—Ç–æ–º–∞—Ä–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (–≤—Å–µ 7 –∞—Ç–æ–º–æ–≤ —Å –Ω–µ–Ω—É–ª–µ–≤—ã–º –≤–µ—Å–æ–º).

        Args:
            Gamma: –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ [N, N]

        Returns:
            –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (atom_projector, projection_channel)
        """
        covering = []

        for dim in self.DIMENSIONS[:self.N]:
            S_k = self.atoms[dim]
            weight = np.real(np.trace(S_k @ Gamma))

            if weight > 1e-10:  # –ù–µ–Ω—É–ª–µ–≤–æ–π –≤–µ—Å
                # –ü—Ä–æ–µ–∫—Ü–∏–æ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª: Œ¶_k(œÅ) = S_k œÅ S_k / Tr(S_k œÅ S_k)
                def projection_channel(rho, proj=S_k):
                    result = proj @ rho @ proj
                    trace = np.trace(result)
                    if np.abs(trace) > 1e-12:
                        return result / trace
                    return result

                covering.append((S_k, projection_channel))

        return covering


# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
def demo_bures_topology():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –ì—Ä–æ—Ç–µ–Ω–¥–∏–∫–∞."""
    # –°–æ–∑–¥–∞–Ω–∏–µ –ì–æ–ª–æ–Ω–æ–º–∞
    holon = Holon(pure=True)
    Gamma = holon.Gamma

    # 1. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä Œ©
    omega = OmegaClassifier()
    print("=== –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä Œ© ===")
    print(f"CPTP-—É—Å–ª–æ–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: {omega.verify_cptp()}")

    # 2. –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–æ—Ä—Ñ–∏–∑–º—ã
    print("\n=== –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–æ—Ä—Ñ–∏–∑–º—ã œá_S ===")
    for dim in omega.DIMENSIONS:
        chi = omega.chi(Gamma, dim)
        print(f"œá_{dim}(Œì) = {chi:.4f}")

    # 3. –ú–µ—Ç—Ä–∏–∫–∞ –ë—é—Ä–µ—Å–∞
    Gamma2 = Holon().Gamma  # –°–º–µ—à–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    d_B = bures_distance(Gamma, Gamma2)
    print(f"\n=== –ú–µ—Ç—Ä–∏–∫–∞ –ë—é—Ä–µ—Å–∞ ===")
    print(f"d_B(Œì_pure, Œì_mixed) = {d_B:.4f}")

    # 4. –ê—Ç–æ–º–∞—Ä–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
    covering = omega.construct_atomic_covering(Gamma)
    print(f"\n=== –ê—Ç–æ–º–∞—Ä–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ ===")
    print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ç–æ–º–æ–≤ —Å –Ω–µ–Ω—É–ª–µ–≤—ã–º –≤–µ—Å–æ–º: {len(covering)}")

    return omega
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install numpy scipy
```

---

## –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–µ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: $\mathcal{R}$ –∏ BQP {#–≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–µ-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ}

:::info –°–≤—è–∑—å —Å —Ç–µ–æ—Ä–∏–µ–π
–ù–µ–ª–∏–Ω–µ–π–Ω–∞—è –∫–≤–∞–Ω—Ç–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ (–ü–æ–ª—á–∏–Ω—Å–∫–∏–π, 1991) –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ—à–∞—Ç—å NP-–ø–æ–ª–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∑–∞ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è. –î–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å $\mathcal{R}$ –≤ –£–ì–ú **–Ω–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç** —Ç–∞–∫–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è.
:::

**–¢–µ–æ—Ä–µ–º–∞ (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏).** –ù–µ–ª–∏–Ω–µ–π–Ω—ã–π —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —á–ª–µ–Ω $\mathcal{R}$ –Ω–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–≤–µ—Ä—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–≤–∞–Ω—Ç–æ–≤–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ BQP.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ (—á–µ—Ç—ã—Ä–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–∞):**

**1. –ü–æ—Ä–æ–≥–æ–≤–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ.**
$\mathcal{R}$ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–∏—Å—Ç–µ–º —Å $R \geq R_{\text{th}} = 1/3$, $\Phi \geq \Phi_{\text{th}} = 1$ ([—É—Ä–æ–≤–µ–Ω—å L2+](/docs/proofs/consciousness/interiority-hierarchy)). –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∏—Ä—É—é—Ç –∫—É–±–∏—Ç–∞–º–∏ ($N = 2$), –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö $R \approx 0$ ‚Üí $\mathcal{R} = 0$, –∏ –¥–∏–Ω–∞–º–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–Ω–∏—Ç–∞—Ä–Ω–∞ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ö–ú).

**2. –¢–µ—Ä–º–æ–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ.**
–ö–∞–∂–¥—ã–π —à–∞–≥ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç $\Delta F > 0$ ‚Äî –∏–º–ø–æ—Ä—Ç–∞ —Å–≤–æ–±–æ–¥–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏. –°–∫–æ—Ä–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å—é –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞:
$$
\frac{dP}{d\tau} \leq \frac{1}{k_B T} \cdot \frac{dF}{d\tau}
$$

**3. CPTP-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ.**
–û–ø–µ—Ä–∞—Ç–æ—Ä $\varphi$ ‚Äî CPTP-–∫–∞–Ω–∞–ª. CPTP-–∫–∞–Ω–∞–ª—ã –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –∫–≤–∞–Ω—Ç–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (data processing inequality):
$$
I(\Gamma_A : \Gamma_B) \geq I(\varphi(\Gamma_A) : \Gamma_B)
$$

**4. –ú–∞—Å—à—Ç–∞–±–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ.**
–ê—Ä–≥—É–º–µ–Ω—Ç –ü–æ–ª—á–∏–Ω—Å–∫–æ–≥–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫—É–±–∏—Ç–æ–≤. –í –£–ì–ú –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–∞–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∏—Ö –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö —Å–∏—Å—Ç–µ–º (L2+). –î–µ–∫–æ–≥–µ—Ä–µ–Ω—Ü–∏—è –ø–æ–¥–∞–≤–ª—è–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–∞–ª—ã–µ –∫–≤–∞–Ω—Ç–æ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è ($\varepsilon \sim 2^{-n}$), –∏ $\mathcal{R}$ –Ω–µ –º–æ–∂–µ—Ç –∏—Ö —É—Å–∏–ª–∏—Ç—å ‚Äî –æ–Ω–∞ –ª–∏—à—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫—É—é –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤—ã—à–µ $P_{\text{crit}} = 2/7$. $\blacksquare$

**–°–º. —Ç–∞–∫–∂–µ:** [–ü–æ–ª–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ —Å —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º–∏ –æ—Ü–µ–Ω–∫–∞–º–∏](/docs/proofs/physics/physics-correspondence#86-–≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–µ-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ).

:::note $G_2$-–∫–æ–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å [–¢]
–ê–ª–≥–æ—Ä–∏—Ç–º—ã, –æ–ø–µ—Ä–∏—Ä—É—é—â–∏–µ –≤ 7D-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ, –º–æ–≥—É—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å [–æ–∫—Ç–æ–Ω–∏–æ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É](/docs/proofs/minimality/theorem-octonionic-derivation): $G_2$-–∫–æ–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —Å–æ–∫—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å $SO(7)$ (21 –ø–∞—Ä–∞–º–µ—Ç—Ä) –¥–æ $G_2$ (14 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤). –ú–æ—Å—Ç [–¢] (–∑–∞–º–∫–Ω—É—Ç, T15).
:::

---

**–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**
- [–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–ø–ø–∞—Ä–∞—Ç](/docs/reference/specification) ‚Äî —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è $\Gamma$, $P$, $d_{\mathrm{FS}}$
- [–ì–æ–ª–æ–Ω–æ–º](/docs/core/structure/holon) ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ $\mathbb{H}$
- [–°–µ–º—å –∏–∑–º–µ—Ä–µ–Ω–∏–π](/docs/core/structure/dimensions) ‚Äî –±–∞–∑–∏—Å $\mathcal{H} = \mathbb{C}^7$
- [–¢–µ–æ—Ä–µ–º–∞ –æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ—Å—Ç–∏ 7D](/docs/proofs/minimality/theorem-minimality-7) ‚Äî –ø–æ—á–µ–º—É $N = 7$
- [–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏](/docs/core/dynamics/coherence-matrix) ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ $\Gamma$
- [–≠–≤–æ–ª—é—Ü–∏—è](/docs/core/dynamics/evolution) ‚Äî —É—Ä–∞–≤–Ω–µ–Ω–∏–µ $d\Gamma/d\tau$
- [–ñ–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å](/docs/core/dynamics/viability) ‚Äî –º–µ—Ä–∞ $P$ –∏ $P_{\text{crit}}$
- [–°–∞–º–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ](/docs/consciousness/foundations/self-observation) ‚Äî –º–µ—Ä—ã $R$, $\Phi$, $D_{\text{diff}}$, $C$
- [–§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ œÜ](/docs/proofs/categorical/formalization-phi) ‚Äî CPTP-–∫–∞–Ω–∞–ª—ã
- [–ò–µ—Ä–∞—Ä—Ö–∏—è –∏–Ω—Ç–µ—Ä–∏–æ—Ä–Ω–æ—Å—Ç–∏](/docs/proofs/consciousness/interiority-hierarchy) ‚Äî —É—Ä–æ–≤–Ω–∏ L0‚ÜíL1‚ÜíL2‚ÜíL3‚ÜíL4 –∏ –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- [–ö–∞—Ç–µ–≥–æ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞–ª–∏–∑–º](/docs/proofs/categorical/categorical-formalism) ‚Äî —Ñ—É–Ω–∫—Ç–æ—Ä $F$
- [–§–∏–∑–∏—á–µ—Å–∫–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ ‚Äî –ó–∞–ø—Ä–µ—Ç —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏](/docs/proofs/physics/physics-correspondence#–∑–∞–ø—Ä–µ—Ç-—Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏) ‚Äî –ø–æ–ª–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ $\mathcal{R}$ —Å no-signaling
